function loadEditAgent(e){$("#agntEditCell").html('<img src="/images/indicator.gif">');var t="/editAllAgent.cfm?agent_id="+e;$("#agntEditCell").load(t,{},function(){history.pushState("data","","/agents.cfm?agent_id="+e)})}function loadAgentSearch(e){var t;$("#agntRslCell").html('<img src="/images/indicator.gif">'),$.ajax({url:"/component/agent.cfc?queryformat=column&method=findAgents&returnformat=json",type:"GET",dataType:"json",data:e,success:function(e){if(e.substring&&"error"==e.substring(0,5))return $("#agntRslCell").html('<span class="importantNotification">'+e+"</span>"),alert(e),!1;if(0===e.ROWCOUNT)return $("#agntRslCell").html('<span class="importantNotification">Nothing Matched.</span>'),!1;for(t='<div style="height:30em; overflow:auto;">',i=0;i<e.ROWCOUNT;i++)t+='<div><span class="likeLink" onclick="loadEditAgent('+e.DATA.AGENT_ID[i]+');">',t+=e.DATA.PREFERRED_AGENT_NAME[i]+'</span><font size="-1"> (',t+=e.DATA.AGENT_TYPE[i]+": "+e.DATA.AGENT_ID[i]+")",t+=' <a target="_blank" href="/agents.cfm?agent_id='+e.DATA.AGENT_ID[i]+'">[new window]</a></font></div>';t+="</div>",$("#agntRslCell").html(t)},error:function(e,t,n){alert(n+": "+t+": "+e)}})}function addGroupMember(){var e=parseInt($("#nnga").val())+parseInt(1),t='<div><input type="hidden" name="member_agent_id_new'+e+'" id="member_agent_id_new'+e+'">';t+='<input type="text" name="group_member_new'+e+'" id="group_member_new'+e+'"',t+=" onchange=\"pickAgentTest('member_agent_id_new"+e+"',this.id,this.value); return false;\"",t+=' onKeyPress="return noenter(event);" placeholder="new group member" class="minput"></div>',$("#newGroupMembers").append(t),$("#nnga").val(e)}function addAgentName(){var e=parseInt($("#nnan").val())+parseInt(1),t='<div id="agentnamedv'+e+'"><select name="agent_name_type_new'+e+'" id="agent_name_type_new'+e+'"></select>';t+='<input type="text" name="agent_name_new'+e+'" id="agent_name_new'+e+'" size="40" placeholder="new agent name" class="minput"></div>',$("#agentnamedv"+$("#nnan").val()).after(t),$("#agent_name_type_new1").find("option").clone().appendTo("#agent_name_type_new"+e),$("#nnan").val(e)}function addAgentStatus(){var e=parseInt($("#nnas").val())+parseInt(1),t='<div id="nas'+e+'" style="display: table-row;"><div style="display:table-cell">';t+='<select name="agent_status_new'+e+'" id="agent_status_new'+e+'" size="1"></select>',t+='</div><div style="display:table-cell"><input type="datetime" class="sinput" placeholder="status date" name="status_date_new'+e+'" id="status_date_new'+e+'"></div>',t+='<div style="display:table-cell"><textarea class="mediumtextarea" name="status_remark_new'+e+'" id="status_remark_new'+e+'" placeholder="status remark"></textarea></div></div>',$("#nas"+$("#nnas").val()).after(t),$("#agent_status_new1").find("option").clone().appendTo("#agent_status_new"+e),$("#status_date_new"+e).datepicker(),$("#nnas").val(e)}function addAgentRelationship(){var e=parseInt($("#nnar").val())+parseInt(1),t='<tr id="nar'+e+'" class="newRec"><td>';t+='<select name="agent_relationship_new'+e+'" id="agent_relationship_new'+e+'" size="1"></select> ',t+='</td><td><input type="hidden" name="related_agent_id_new'+e+'" id="related_agent_id_new'+e+'">',t+='<input type="text" name="related_agent_new'+e+'" id="related_agent_new'+e+'"',t+="onchange=\"pickAgentTest('related_agent_id_new"+e+"',this.id,this.value); return false;\"",t+='onKeyPress="return noenter(event);" placeholder="pick related agent" class="minput">',t+="</td></tr>",$("#nar"+$("#nnar").val()).after(t),$("#agent_relationship_new1").find("option").clone().appendTo("#agent_relationship_new"+e),$("#nnar").val(e)}function addAddress(){var e=parseInt($("#nnea").val())+parseInt(1),t='<div id="eaddiv'+e+'" class="newRec">';t+='<select name="address_type_new'+e+'" id="address_type_new'+e+'" size="1"></select>',t+='<input type="text" class="minput" name="address_new'+e+'" id="address_new'+e+'" placeholder="add address">',t+='<select name="valid_addr_fg_new'+e+'" id="valid_addr_fg_new'+e+'"></select>',t+='<textarea class="smalltextarea" placeholder="remark" name="address_remark_new'+e+'" id="address_remark_new'+e+'"></textarea>',t+="</div>",$("#eaddiv"+$("#nnea").val()).after(t),$("#address_type_new1").find("option").clone().appendTo("#address_type_new"+e),$("#valid_addr_fg_new1").find("option").clone().appendTo("#valid_addr_fg_new"+e),$("#nnea").val(e)}function rankAgent(e){var t="/includes/forms/agentrank.cfm?agent_id="+e;$("<div id='dialog' class='popupDialog'><img src='/images/indicator.gif'></div>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Rank Agent",width:"auto",close:function(){$(this).remove()}}).load(t,function(){$(this).dialog("option","position",["center","center"])}),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function editAgentAddress(e){var t="includes/forms/editAgentAddr.cfm?action=editAddress&addr_id="+e;$("<div id='dialog' class='popupDialog'><img src='/images/indicator.gif'></div>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Edit Address",width:"auto",close:function(){$(this).remove()}}).load(t,function(){$(this).dialog("option","position",["center","center"])}),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getUrlParameter(e){for(var t=window.location.search.substring(1),n=t.split("&"),a=0;a<n.length;a++){var o=n[a].split("=");if(o[0]==e)return o[1]}}function checkReplaceNoPrint(e,t){if(0!==$("#"+t).val().length){var n;$("#"+t).val().indexOf("[NOPRINT]")>=0&&(alert("remove [NOPRINT] from "+t),e.preventDefault()),$.ajax({url:"/component/functions.cfc?queryformat=column",type:"GET",dataType:"json",async:!1,data:{method:"removeNonprinting",orig:$("#"+t).val(),userString:"[NOPRINT]",returnformat:"json"},success:function(a){a.DATA.REPLACED_WITH_USERSTRING[0]!=$("#"+t).val()&&($("#"+t).val(a.DATA.REPLACED_WITH_USERSTRING[0]),n="The form cannot be submitted: There are nonprinting characters in "+t+".\n\n",n+="Nonprinting characters have been replaced with [NOPRINT]. Remove that to continue.\n\n",n+="You may use HTML markup for print control: <br> is linebreak",alert(n),e.preventDefault())},error:function(e,t,n){alert(n+": "+t+": "+e)}})}}function setSessionCustomID(e){$.getJSON("/component/functions.cfc",{method:"setSessionCustomID",val:e,returnformat:"json",queryformat:"column"},function(){})}function jqueryspecialescape(e){var t=e.replace(/[ !"#$%&'()*+,.\/:;<=>?@^`{|}~]/g,"\\$&");return t}function setPrevSearch(){for(var e=get_cookie("schParams"),t=e.split("|"),n=0;n<t.length;n++){var a=t[n].split("::"),o=a[0],i=a[1];if(document.getElementById(o))if("collection_id"==o){var r=i.split(",");for(x=0;x<r.length;x++){var c=r[x];$("#collection_id").find("option[value="+c+"]").prop("selected","selected")}$("#collection_id").multiselect("refresh")}else if("OIDType"==o){var r=i.split(",");for(x=0;x<r.length;x++){var c=jqueryspecialescape(r[x]);$("#OIDType").find("option[value="+c+"]").prop("selected","selected")}$("#OIDType").multiselect("refresh")}else if("groupBy"==o){var r=i.split(",");for(x=0;x<r.length;x++){var c=jqueryspecialescape(r[x]);$("#groupBy").find("option[value="+c+"]").prop("selected","selected")}$("#groupBy").multiselect("refresh")}else"tgtForm"==o?changeTarget(o,i):$("#"+o).val(i)}try{setPreviousMap()}catch(l){}}function changeTarget(e,t){0===t.length&&(t="SpecimenResults.cfm"),$("#tgtForm").val(t),"SpecimenResultsSummary.cfm"==t?($("#groupByDiv").show(),$("#kmlDiv").hide()):"/bnhmMaps/kml.cfm?action=newReq"==t?($("#groupByDiv").hide(),$("#kmlDiv").show()):($("#groupByDiv").hide(),$("#kmlDiv").hide()),$("#SpecData").attr("action",t)}function resetSSForm(){document.getElementById("SpecData").reset();try{initialize()}catch(e){}}function r_getSpecSrchPref(e){var t;t=e.split(",");for(var n=0;n<t.length;n++)t[n].length>0&&showHide(t[n],1)}function checkCSV(e){var t,n;t=e.value,n=t.substring(t.lastIndexOf(".")+1).toLowerCase(),"csv"!=n?(alert("Only files with the file extension CSV are allowed"),$("input[type=submit]").hide()):$("input[type=submit]").show()}function getMedia(e,t,n,a,o){var i;$("#imgBrowserCtlDiv").append('<img src="/images/indicator.gif">'),i="/form/inclMedia.cfm?typ="+e+"&q="+t+"&tgt="+n+"&rpp="+a+"&pg="+o,$.get(i,function(e){$("#"+n).html(e)})}function blockSuggest(e){$.getJSON("/component/functions.cfc",{method:"changeBlockSuggest",onoff:e,returnformat:"json",queryformat:"column"},function(e){"success"==e?$("#browseArctos").html("Suggest Browser disabled. You may turn this feature back on under My Stuff."):alert("An error occured! \n "+e)})}function findPart(e,t,n){var a,o;a="/picks/findPart.cfm",t=t.replace("%","_"),o=a+"?part_name="+t+"&collCde="+n+"&partFld="+e,partpick=window.open(o,"","width=400,height=338, resizable,scrollbars")}function isValidEmailAddress(e){var t;return t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i),t.test(e)}function saveThisAnnotation(){var e,t,n,a,o;return e=document.getElementById("idtype").value,t=document.getElementById("idvalue").value,n=document.getElementById("annotation").value,a=$("#captchaHash").val(),o=$("#captcha").val().toUpperCase(),n.length<=20?(alert("You must enter an annotation of at least 20 characters to save."),!1):isValidEmailAddress($("#email").val())?void $.getJSON("/component/functions.cfc",{method:"hashString",string:o,returnformat:"json"},function(o){return o!=a?(alert("The CAPTCHA text you entered does not match the image."),!1):void $.getJSON("/component/functions.cfc",{method:"addAnnotation",idType:e,idvalue:t,annotation:n,returnformat:"json",queryformat:"column"},function(e){return"success"==e?(closeAnnotation(),alert("Your annotations have been saved, and the appropriate curator will be alerted. \n Thank you for helping improve Arctos!")):alert("An error occured! \n "+e),!0})}):(alert("Enter a valid email address."),!1)}function openAnnotation(e){var t,n,a;t=document.createElement("div"),t.id="bgDiv",t.className="bgDiv",t.setAttribute("onclick","closeAnnotation()"),document.body.appendChild(t),n=document.createElement("div"),n.id="annotateDiv",n.className="annotateBox",n.innerHTML="",n.src="",document.body.appendChild(n),a="/info/annotate.cfm?q="+e,$("#annotateDiv").load(a,{},function(){})}function closeAnnotation(){var e;e=document.getElementById("bgDiv"),document.body.removeChild(e),e=document.getElementById("annotateDiv"),document.body.removeChild(e)}function archiveSpecimens(){return p="Archive search RESULTS. Use Save Search to save CRITERIA.\n",p+=" Type a name for the archive. Names must consist only of lower-case letters, numbers, dash (-), and underbar (_).\n",p+=" The process will take a few seconds; hang tight until you get a confirmation.\n",p+="'myarchive' will create a new archive (or fail); '+myarchive' will append to your existing archive 'myarchive' (or fail).",sName=prompt(p),sName?void $.getJSON("/component/functions.cfc",{method:"archiveSpecimen",archive_name:sName,returnformat:"json",queryformat:"column"},function(e){alert(e)}):!1}function lockArchive(e){var t=confirm("Are you sure you want to lock this Archive?");return t!==!0?!1:void jQuery.getJSON("/component/functions.cfc",{method:"lockArchive",archive_name:e,returnformat:"json",queryformat:"column"},function(e){alert(e)})}function changeCollection(e){jQuery.getJSON("/component/functions.cfc",{method:"changeexclusive_collection_id",tgt:"",returnformat:"json",queryformat:"column"},function(){document.location=e})}function saveSearch(e,t){var n,a,o,i,r;n=Date.now(),"undefined"!=typeof t&&t.length>0&&(r="ERROR: "+t+"\n\n"),r="Saving search for URL:\n\n"+e+" \n\nName your saved search (or copy and ",r+="paste the link above).\n\nManage or email saved searches from your profile, or go to /saved/{name of saved search}. Note ",r+="that saved searches, except those sepecifying only GUIDs, are dynamic; results change as data changes.\n\nName of saved search (must be unique):\n",a=prompt(r,n),null!==a&&(o=encodeURIComponent(a),i=e,$.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:i,srchName:o,returnformat:"json",queryformat:"column"},function(t){if("success"!=t){if(alert(t),"You must create an account or log in to save searches."==t)return!1;saveSearch(e,t)}else pathArray=window.location.href.split("/"),protocol=pathArray[0],host=pathArray[2],url=protocol+"//"+host,alert("Saved search \n"+url+"/saved/"+o+"\n Find it in the My Stuff tab.")}))}function crcloo(e,t){$.getJSON("/component/functions.cfc",{method:"clientResultColumnList",ColumnList:e,in_or_out:t,returnformat:"json",queryformat:"column"})}function checkAllById(e){var t;t=e.split(","),$.each(t,function(e,t){$("#"+t).prop("checked",!0)}),crcloo(e,"in")}function uncheckAllById(e){var t;t=e.split(","),$.each(t,function(e,t){$("#"+t).prop("checked",!1)}),crcloo(e,"out")}function hidePageLoad(){$("#loading").hide()}function addPartToContainer(){var e,t,n,a,o;return document.getElementById("pTable").className="red",e=document.getElementById("collection_object_id").value,t=document.getElementById("part_name").value,n=document.getElementById("part_name_2").value,a=document.getElementById("parent_barcode").value,o=document.getElementById("new_container_type").value,0===e.length||0===t.length||0===a.length?(alert("Something is null"),!1):void $.getJSON("/component/functions.cfc",{method:"addPartToContainer",collection_object_id:e,part_id:t,part_id2:n,parent_barcode:a,new_container_type:o,returnformat:"json",queryformat:"column"},function(e){statAry=e.split("|");var t=statAry[0],n=statAry[1];document.getElementById("pTable").className="";var a=document.getElementById("msgs"),o=document.getElementById("msgs_hist"),i=a.innerHTML+"<hr>"+o.innerHTML;o.innerHTML=i,a.innerHTML=n,0===t?a.className="error":(a.className="successDiv",document.getElementById("oidnum").focus(),document.getElementById("oidnum").select(),getParts())})}function clonePart(){var e=document.getElementById("collection_id").value,t=document.getElementById("other_id_type").value,n=document.getElementById("oidnum").value;e.length>0&&t.length>0&&n.length>0?$.getJSON("/component/functions.cfc",{method:"getSpecimen",collection_id:e,other_id_type:t,oidnum:n,returnformat:"json",queryformat:"column"},function(e){toString(e.DATA.COLLECTION_OBJECT_ID[0]).indexOf("Error:")>-1?alert(e.DATA.COLLECTION_OBJECT_ID[0]):newPart(e.DATA.COLLECTION_OBJECT_ID[0])}):alert("Error: cannot resolve ID to specimen.")}function checkSubmit(){var e;e=document.getElementById("submitOnChange").checked,e===!0&&addPartToContainer()}function newPart(e){var t,n;collection_id=document.getElementById("collection_id").value,t=document.getElementById("part_name").value,n="/form/newPart.cfm",n+="?collection_id="+collection_id,n+="&collection_object_id="+e,n+="&part="+t,divpop(n)}function getParts(){var e,t,n,a,o,r,c,l,d,s,u,m,p,f,h,g,v,_,y,b;e=document.getElementById("collection_id").value,t=document.getElementById("other_id_type").value,n=document.getElementById("oidnum").value,e.length>0&&t.length>0&&n.length>0&&(a=document.createElement("DIV"),a.id="ajaxStatus",a.className="ajaxStatus",a.innerHTML="Fetching parts...",document.body.appendChild(a),o=document.getElementById("noBarcode").checked,r=document.getElementById("noSubsample").checked,$.getJSON("/component/functions.cfc",{method:"getParts",collection_id:e,other_id_type:t,oidnum:n,noBarcode:o,noSubsample:r,returnformat:"json",queryformat:"column"},function(e){if(c=e.DATA,a=document.getElementById("ajaxStatus"),document.body.removeChild(a),l=document.getElementById("thisSpecimen"),d=document.getElementById("collection_id"),s=document.getElementById("collection_object_id"),u=document.getElementById("part_name"),m=document.getElementById("part_name_2"),p=u.value,f=m.value,u.options.length=0,m.options.length=0,h=d.selectedIndex,g=d.options[h].text,v=document.getElementById("other_id_type").value,_=document.getElementById("oidnum").value,y=g+" "+v+" "+_,c.PART_NAME[0].indexOf("Error:")>-1)l.className="error",y+=" = "+c.PART_NAME[0],s.value="",document.getElementById("pTable").className="red";else{for(document.getElementById("pTable").className="",l.className="",s.value=c.COLLECTION_OBJECT_ID[0],b=document.createElement("option"),b.setAttribute("value",""),b.appendChild(document.createTextNode("")),m.appendChild(b),i=0;i<e.ROWCOUNT;i++)b=document.createElement("option"),option2=document.createElement("option"),b.setAttribute("value",c.PARTID[i]),option2.setAttribute("value",c.PARTID[i]),pStr=c.PART_NAME[i],null!==c.BARCODE[i]&&(pStr+=" ["+c.BARCODE[i]+"]"),b.appendChild(document.createTextNode(pStr)),option2.appendChild(document.createTextNode(pStr)),u.appendChild(b),m.appendChild(option2);u.value=p,m.value=f,y+=" = "+c.COLLECTION[0]+" "+c.CAT_NUM[0]+" ("+c.CUSTOMIDTYPE[0]+" "+c.CUSTOMID[0]+")"}l.innerHTML=y}))}function divpop(e){var t,n,a;n=document.createElement("div"),n.id="bgDiv",n.className="bgDiv",document.body.appendChild(n),a=document.createElement("div"),a.id="ppDiv",a.className="pickBox",a.innerHTML="Loading....",a.src="",document.body.appendChild(a),window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),void 0!==t&&(t.onreadystatechange=function(){divpopDone(t)},t.open("GET",e,!0),t.send(""))}function divpopDone(e){if(4==e.readyState){document.getElementById("ppDiv").innerHTML=200==e.status?e.responseText:"ahah error:\n"+e.statusText;var t=document.getElementById("ppDiv"),n=document.createElement("span");n.className="popDivControl",n.setAttribute("onclick","divpopClose();"),n.innerHTML="X",t.appendChild(n)}}function divpopClose(){var e=document.getElementById("ppDiv");document.body.removeChild(e);var t=document.getElementById("bgDiv");document.body.removeChild(t)}function makePart(){var e,t,n,a,o,i,r,c,l,d,s,u,m;e=document.getElementById("collection_object_id").value,t=document.getElementById("npart_name").value,n=document.getElementById("lot_count").value,a=document.getElementById("coll_obj_disposition").value,o=document.getElementById("condition").value,i=document.getElementById("coll_object_remarks").value,r=document.getElementById("barcode").value,c=document.getElementById("new_container_type").value,$.getJSON("/component/functions.cfc",{method:"makePart",collection_object_id:e,part_name:t,lot_count:n,coll_obj_disposition:a,condition:o,coll_object_remarks:i,barcode:r,new_container_type:c,returnformat:"json",queryformat:"column"},function(e){l=e.DATA,d=l.STATUS[0],"error"==d?(s=l.MSG[0],alert(s)):(s="Created part: ",s+=l.PART_NAME[0]+" ",null!==l.BARCODE[0]&&(s+="barcode "+l.BARCODE[0],null!==l.NEW_CONTAINER_TYPE[0]&&(s+="( "+l.NEW_CONTAINER_TYPE[0]+")")),u=document.getElementById("ppDiv"),document.body.removeChild(u),m=document.getElementById("bgDiv"),document.body.removeChild(m),getParts())})}function getAgentInfo(e){removeHelpDiv();var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",t.setAttribute("onclick","removeHelpDiv()"),document.body.appendChild(t);var n=document.createElement("div");n.id="helpDiv",n.className="helpBox centered",n.innerHTML='<img src="/images/indicator.gif" style="margin:5em;">',document.body.appendChild(n),$(n).load("/ajax/agentInfo.cfm",{agent_id:e,addCtl:1})}function scrollToAnchor(e){var t=$("a[name='"+e+"']");$("html,body").animate({scrollTop:t.offset().top},"slow")}function changefancyCOID(e){$.getJSON("/component/functions.cfc",{method:"changefancyCOID",tgt:e,returnformat:"json",queryformat:"column"},function(e){if("success"==e){document.getElementById("fancyCOID").className=""}else alert("An error occured: "+e)})}function changeBigSearch(e){$.getJSON("/component/functions.cfc",{method:"changeBigSearch",tgt:e,returnformat:"json",queryformat:"column"},function(e){if("success"==e){document.getElementById("changeBigSearch").className=""}else alert("An error occured: "+e)})}function changecustomOtherIdentifier(e){$.getJSON("/component/functions.cfc",{method:"changecustomOtherIdentifier",tgt:e,returnformat:"json",queryformat:"column"},function(e){"success"==e?document.getElementById("customOtherIdentifier").className="":alert("An error occured: "+e)})}function removeHelpDiv(){$("#bgDiv").remove(),$("#helpDiv").remove()}function saveSpecSrchPref(e,t){var n,a,o,r,c;$.getJSON("/component/functions.cfc",{method:"saveSpecSrchPref",id:e,onOff:t,returnformat:"json",queryformat:"column"},function(l){if(n=l.split(","),a=n[0],e=n[1],t=n[2],"cookie"==a){if(o=[],r=readCookie("specsrchprefs"),c=-1,null!==r)for(o=r.split(","),i=0;i<o.length;i++)o[i]==e&&(c=i);1==t?-1==c&&o.push(e):-1!=c&&o.splice(c,1);var d=o.join();createCookie("specsrchprefs",d,0)}})}function showHide(e,t){var n,a,o;$("#c_"+e).length&&$("#e_"+e).length&&("spatial_query"==e?(a='<span class="secControl" style="font-size:.9em;" id="c_'+e+'" onclick="showHide(\''+e+"',0)\">Hide Google Map</span>",n='<span class="secControl" style="font-size:.9em;" id="c_'+e+'" onclick="showHide(\''+e+"',1)\">Select on Google Map</span>"):(a='<span class="secControl" id="c_'+e+'" onclick="showHide(\''+e+"',0)\">Show Fewer Options</span>",n='<span class="secControl" id="c_'+e+'" onclick="showHide(\''+e+"',1)\">Show More Options</span>"),1==t?(o="/includes/SpecSearch/"+e+".cfm",$("#c_"+e).html('<img src="/images/indicator.gif">'),$.get(o,function(n){$("#e_"+e).html(n),$("#c_"+e).replaceWith(a),saveSpecSrchPref(e,t)})):($("#e_"+e).html(""),$("#c_"+e).replaceWith(n),saveSpecSrchPref(e,t)))}function closeAndRefresh(){var e;document.location=location.href,e=document.getElementById("customDiv"),document.body.removeChild(e)}function getFormValues(){spAry=[],$("#SpecData *").filter(":input").each(function(){if($(this).val()){var e=this.name+"::"+String($(this).val());-1==spAry.indexOf(e)&&spAry.push(e)}}),str=spAry.join("|"),document.cookie="schParams="+str}function createCookie(e,t,n){var a,o;n?(o=new Date,o.setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toGMTString()):a="",document.cookie=e+"="+t+a+"; path=/"}function readCookie(e){var t,n,a,o;for(t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}function get_cookie(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?unescape(t[2]):null}function changeexclusive_collection_id(e){$.getJSON("/component/functions.cfc",{method:"changeexclusive_collection_id",tgt:e,returnformat:"json",queryformat:"column"},function(e){if("success"==e){document.getElementById("exclusive_collection_id").className=""}else alert("An error occured: "+e)})}function IsNumeric(e){var t,n="0123456789.",a=!0;for(i=0;i<e.length&&a===!0;i++)t=e.charAt(i),-1==n.indexOf(t)&&(a=!1);return a}function orapwCheck(e,t){var n=/^[A-Za-z0-9!$%&_?(\-)<>=/:;*\.]$/,a=6,o="Password is acceptable";e.indexOf(t)>-1&&(o="Password may not contain your username."),(e.length<a||e.length>30)&&(o="Password must be between "+a+" and 30 characters."),e.match(/[a-zA-Z]/)||(o="Password must contain at least one letter."),e.match(/\d+/)||(o="Password must contain at least one number."),e.match(/[!,$,%,&,*,?,_,-,(,),<,>,=,/,:,;,.]/)||(o="Password must contain at least one of: !,$,%,&,*,?,_,-,(,),<,>,=,/,:,;.");for(var i=0;i<e.length;i++)e.charAt(i).match(n)||(o="Password may contain only A-Z, a-z, 0-9, and !$%&()`*+,-/:;<=>?_.");return o}function getCtDoc(e,t){var n,a;n="/info/ctDocumentation.cfm?table="+e+"&field="+t,a=windowOpener(n,"ctDocWin","width=700,height=400, resizable,scrollbars")}function windowOpener(e,t,n){popupWins=[],"object"!=typeof popupWins[t]?popupWins[t]=window.open(e,t,n):popupWins[t].closed?popupWins[t]=window.open(e,t,n):popupWins[t].location.href=e,popupWins[t].focus()}function getDocs(e,t){$.getJSON("/component/functions.cfc",{method:"get_docs",uri:e,anchor:t,returnformat:"json"},function(e){"404"==e?alert("help not found."):siteHelpWin=windowOpener(e,"HelpWin","width=800,height=600, resizable,scrollbars,location,toolbar")})}function noenter(e){var t;return t=window.event?window.event.keyCode:e.which,13==t?!1:!0}function chgCondition(e){helpWin=windowOpener("/picks/condition.cfm?collection_object_id="+e,"conditionWin","width=800,height=338, resizable,scrollbars")}function getLoan(e,t,n,a){var o,i;o="/picks/getLoan.cfm",i=o+"?LoanIDFld="+e+"&LoanNumberFld="+t+"&loanNumber="+n+"&agent_name="+a,loanpickwin=window.open(i,"","width=400,height=338, resizable,scrollbars")}function pickAgentModal(e,t,n){n=encodeURIComponent(n),$("#"+t).addClass("badPick");var a;a="undefined"!=typeof n?n:"";var o="/picks/findAgentModal.cfm?agentIdFld="+e+"&agentNameFld="+t+"&name="+a;$("<iframe src='"+o+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Pick Agent",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getAgent(e,t,n,a,o){var i,r;i="/picks/findAgent.cfm",r=i+"?agentIdFld="+e+"&agentNameFld="+t+"&formName="+n+"&agent_name="+a+"&allowCreation="+o,agentpickwin=window.open(r,"","width=400,height=338, resizable,scrollbars")}function getProject(e,t,n,a){var o,i;o="/picks/findProject.cfm",i=o+"?projIdFld="+e+"&projNameFld="+t+"&formName="+n+"&project_name="+a,projpickwin=window.open(i,"","width=400,height=338, resizable,scrollbars")}function findCatalogedItem(e,t,n,a,o,i){var r,c;r="/picks/findCatalogedItem.cfm",c=r+"?collIdFld="+e+"&CatNumStrFld="+t+"&formName="+n+"&oidType="+a+"&oidNum="+o+"&collID="+i,catItemWin=window.open(c,"","width=400,height=338, resizable,scrollbars")}function findCollEvent(e,t,n,a){var o,i;o="/picks/findCollEvent.cfm",i=o+"?collIdFld="+e+"&dispField="+n+"&formName="+t+"&collecting_event_name="+a,ColPickwin=window.open(i,"","width=800,height=600, resizable,scrollbars")}function getPublication(e,t,n,a){var o,i;o="/picks/findPublication.cfm",i=o+"?pubStringFld="+e+"&pubIdFld="+t+"&publication_title="+n+"&formName="+a,i=window.open(i,"","width=400,height=338, resizable,scrollbars")}function getAccn(e,t,n){var a="/picks/findAccn.cfm",o=a+"?r_accnNumber="+e+"&rtnFldID="+t+"&r_InstAcrColnCde="+n;o=window.open(o,"","width=400,height=338, resizable,scrollbars")}function getAccnMedia(e,t){var n,a;n="/picks/getAccnMedia.cfm",a=n+"?idOfTxtFld="+e+"&idOfPKeyFld="+t,a=window.open(a,"","width=400,height=338, resizable,scrollbars")}function getAccn2(e,t){var n,a;n="/picks/getAccn.cfm",a=n+"?accnNumber="+e+"&collectionID="+t,a=window.open(a,"","width=400,height=338, resizable,scrollbars")}function getGeog(e,t,n,a){var o,i;o="/picks/findHigherGeog.cfm",i=o+"?geogIdFld="+e+"&geogStringFld="+t+"&formName="+n+"&geogString="+a,geogpickwin=window.open(i,"","width=400,height=338, resizable,scrollbars")}function confirmDelete(e,t){var n;return t=t||"this record",n=confirm("Are you sure you want to delete "+t+"?"),n!==!0?!1:void document[e].submit()}function getHistory(e){historyWin=windowOpener("/info/ContHistory.cfm?container_id="+e,"historyWin","width=800,height=600, resizable,scrollbars")}function getQuadHelp(){helpWin=windowOpener("/info/quad.cfm","quadHelpWin","width=800,height=600, resizable,scrollbars,status")}function getLegal(e){helpWin=windowOpener("/info/legal.cfm?content="+e,"legalWin","width=400,height=338, resizable,scrollbars")}function getInfo(e,t){infoWin=windowOpener("/info/SpecInfo.cfm?subject="+e+"&thisId="+t,"infoWin","width=800,height=500, resizable,scrollbars")}function findMedia(e,t,n){var a,o;a="/picks/findMedia.cfm",o=a+"?mediaIdFld="+t+"&mediaStringFld="+e+"&media_uri="+n,mediapick=window.open(o,"","width=400,height=338, resizable,scrollbars")}function taxaPick(e,t,n,a){var o,i;o="/picks/TaxaPick.cfm",i=o+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+n+"&scientific_name="+a,taxapick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function taxaPickIdentification(e,t,n,a){var o,i;o="/picks/TaxaPickIdentification.cfm",i=o+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+n+"&scientific_name="+a,taxapick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function CatItemPick(e,t,n,a){var o,i,r;o="/picks/CatalogedItemPick.cfm",i=o+"?collIdFld="+e+"&catNumFld="+t+"&formName="+n+"&sciNameFld="+a,r=window.open(i,"","width=400,height=338, resizable,scrollbars")}function findAgentName(e,t,n){var a,o;a="/picks/findAgentName.cfm",o=a+"?agentIdFld="+e+"&agentNameFld="+t+"&agentName="+n,agentpick=window.open(o,"","width=400,height=338, resizable,scrollbars")}function addrPick(e,t,n){var a,o;a="/picks/AddrPick.cfm",o=a+"?addrIdFld="+e+"&addrFld="+t+"&formName="+n,addrpick=window.open(o,"","width=400,height=338, resizable,scrollbars")}function GeogPick(e,t,n){var a,o;a="/picks/GeogPick2.cfm",o=a+"?geogIdFld="+e+"&highGeogFld="+t+"&formName="+n,geogpick=window.open(o,"","width=600,height=600, toolbar,resizable,scrollbars,")}function LocalityPick(e,t,n,a){var o,i;o="/picks/LocalityPick.cfm",i=o+"?localityIdFld="+e+"&speclocFld="+t+"&formName="+n+"&locality_name="+a,localitypick=window.open(i,"","width=800,height=600,resizable,scrollbars,")}function findJournal(e,t,n,a){var o,i,r;o="/picks/findJournal.cfm",i=o+"?journalIdFld="+e+"&journalNameFld="+t+"&formName="+n+"&journalName="+a,r=window.open(i,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function deleteEncumbrance(e,t){var n,a,o;n="/picks/DeleteEncumbrance.cfm",a=n+"?encumbrance_id="+e+"&collection_object_id="+t,o=window.open(a,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function getAllSheets(){var e,t,n,a;if(!window.ScriptEngine&&navigator.__ice_version)return document.styleSheets;if(document.getElementsByTagName)e=document.getElementsByTagName("LINK"),t=document.getElementsByTagName("STYLE");else{if(!document.styleSheets||!document.all)return[];e=document.all.tags("LINK"),t=document.all.tags("STYLE")}for(a=0,os=[];e[a];a++)n=e[a].rel?e[a].rel:e[a].getAttribute?e[a].getAttribute("rel"):"","string"==typeof n&&n.toLowerCase().indexOf("style")+1&&(os[os.length]=e[a]);for(a=0;t[a];a++)os[os.length]=t[a];return os}function changeStyle(){var e,t;for(e=0,ss=getAllSheets();ss[e];e++)for(ss[e].title&&(ss[e].disabled=!0),t=0;t<arguments.length;t++)ss[e].title==arguments[t]&&(ss[e].disabled=!1);ss.length||alert("Your browser cannot change stylesheets")}function toProperCase(e){var t=document.getElementById(e),n=(t.value.length,t.selectionStart),a=t.selectionEnd,o=t.value.substring(n,a),i=o.toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()}),r=t.value.substring(0,n),c=t.value.substring(a,t.value.length),l=r+i+c;t.value=l}function italicize(e){var t=document.getElementById(e),n=t.value.length,a=t.selectionStart,o=t.selectionEnd,i=t.value.substring(a,o);
if(i.length>0){var r="<i>"+i+"</i>";t.value=t.value.substring(0,a)+r+t.value.substring(o,n)}}function bold(e){var t=document.getElementById(e),n=t.value.length,a=t.selectionStart,o=t.selectionEnd,i=t.value.substring(a,o);if(i.length>0){var r="<b>"+i+"</b>";t.value=t.value.substring(0,a)+r+t.value.substring(o,n)}}function superscript(e){var t=document.getElementById(e),n=t.value.length,a=t.selectionStart,o=t.selectionEnd,i=t.value.substring(a,o);if(i.length>0){var r="<sup>"+i+"</sup>";t.value=t.value.substring(0,a)+r+t.value.substring(o,n)}}function subscript(e){var t=document.getElementById(e),n=t.value.length,a=t.selectionStart,o=t.selectionEnd,i=t.value.substring(a,o);if(i.length>0){var r="<sub>"+i+"</sub>";t.value=t.value.substring(0,a)+r+t.value.substring(o,n)}}function setPartAttOptions(e,t){var n,o,i,r,c,l;$.getJSON("/component/functions.cfc",{method:"getPartAttOptions",returnformat:"json",patype:t},function(t){if(n=t.TYPE,o="attribute_value_"+e,r="attribute_units_"+e,"unit"==t.TYPE){for(i='<input type="text" name="'+o+'" id="'+o+'">',$("#v_"+e).html(i),c=t.VALUES.split("|"),i='<select name="'+r+'" id="'+r+'">',a=0;a<c.length;++a)i+='<option value="'+c[a]+'">'+c[a]+"</option>";i+="</select>",$("#u_"+e).html(i)}else if("value"==t.TYPE){for(c=t.VALUES.split("|"),i='<select name="'+o+'" id="'+o+'">',a=0;a<c.length;++a)i+='<option value="'+c[a]+'">'+c[a]+"</option>";i+="</select>",$("#v_"+e).html(i),$("#u_"+e).html("")}else l='<textarea name="'+o+'" id="'+o+'" class="smalltextarea"></textarea>',$("#v_"+e).html(l),$("#u_"+e).html("")})}function mgPartAtts(e){addBGDiv("closePartAtts()");var t=document.createElement("iFrame");t.id="partsAttDiv",t.className="annotateBox",t.innerHTML="<br>Loading...",document.body.appendChild(t);var n="/form/partAtts.cfm?partID="+e;t.src=n}function closePartAtts(){$("#bgDiv").remove(),$("#partsAttDiv").remove(),$("#bgDiv",window.parent.document).remove(),$("#partsAttDiv",window.parent.document).remove()}function removeUpload(){document.getElementById("uploadDiv")&&$("#uploadDiv").remove(),removeBgDiv()}function closeUpload(e,t){document.getElementById("media_uri").value=e,document.getElementById("preview_uri").value=t;var n=e.split(".").pop();"jpg"==n||"jpeg"==n?($("#mime_type").val("image/jpeg"),$("#media_type").val("image")):"pdf"==n?($("#mime_type").val("application/pdf"),$("#media_type").val("text")):"mp3"==n?($("#mime_type").val("audio/mpeg3"),$("#media_type").val("audio")):"wav"==n?($("#mime_type").val("audio/x-wav"),$("#media_type").val("audio")):"dng"==n?($("#mime_type").val("image/dng"),$("#media_type").val("image")):"png"==n?($("#mime_type").val("image/png"),$("#media_type").val("image")):"tif"==n||"tiff"==n?($("#mime_type").val("image/tiff"),$("#media_type").val("image")):"htm"==n||"html"==n?($("#mime_type").val("text/html"),$("#media_type").val("")):"txt"==n?($("#mime_type").val("text/plain"),$("#media_type").val("text")):"mp4"==n&&($("#mime_type").val("video/mp4"),$("#media_type").val("video")),removeUpload()}function generateMD5(){var e;$.getJSON("/component/functions.cfc",{method:"genMD5",uri:$("#media_uri").val(),returnformat:"json",queryformat:"column"},function(t){e=parseInt($("#number_of_labels").val())+parseInt(1),addLabel(e),$("#label__"+e).val("MD5 checksum"),$("#label_value__"+e).val(t)})}function closePreviewUpload(e){var t=document.getElementById("uploadDiv");document.body.removeChild(t),document.getElementById("preview_uri").value=e}function clickUploadPreview(){var e=document.createElement("iFrame");e.id="uploadDiv",e.name="uploadDiv",e.className="uploadMediaDiv",document.body.appendChild(e);var t="/info/upMediaPreview.cfm";e.src=t}function pickedRelationship(e){var t=document.getElementById(e).value,n=e.lastIndexOf("__"),a=e.substring(n+2,e.length),o=t.split(" "),i=o[o.length-1],r="related_id__"+a,c="related_value__"+a,l=document.getElementById(r);l.value="";var d=document.getElementById(c);d.value="",""===i||("agent"==i?getAgent(r,c,"newMedia",""):"locality"==i?LocalityPick(r,c,"newMedia"):"collecting_event"==i?findCollEvent(r,"newMedia",c):"cataloged_item"==i?findCatalogedItem(r,c,"newMedia"):"project"==i?getProject(r,c,"newMedia"):"taxonomy"==i?taxaPick(r,c,"newMedia"):"publication"==i?getPublication(c,r,"","newMedia"):"accn"==i?getAccnMedia(c,r):"media"==i?findMedia(c,r):"loan"==i?getLoan(r,c):"delete"==i?document.getElementById(c).value="Marked for deletion.....":alert("Something is broken. I have no idea what to do with a relationship to "+i))}function addRelation(e){var t,n,a,o,i,r,l,d,s,u,m,p,f;t=document.getElementById("relationships"),n=document.createElement("div"),n.id="relationshipDiv__"+e,t.appendChild(n),a=e-1,o="relationship__"+a,i=document.getElementById(o).cloneNode(!0),i.name="relationship__"+e,i.id="relationship__"+e,i.value="delete",n.appendChild(i),c=document.createElement("textNode"),c.innerHTML=":&nbsp;",n.appendChild(c),a=e-1,r="related_value__"+a,l=document.getElementById(r).cloneNode(!0),l.name="related_value__"+e,l.id="related_value__"+e,l.value="",n.appendChild(l),d="related_id__"+a,s=document.getElementById(d).cloneNode(!0),s.name="related_id__"+e,s.id="related_id__"+e,n.appendChild(s),u=document.getElementById("addRelationship"),t.removeChild(u),m=e+1,p="addRelation("+m+")",u.setAttribute("onclick",p),t.appendChild(u),f=document.getElementById("number_of_relations"),f.value=parseInt(f.value)+1}function addLabel(e){var t,n,a,o,i,r,l,d,s,u,m;t=document.getElementById("labels"),n=document.createElement("div"),n.id="labelsDiv__"+e,t.appendChild(n),a=e-1,o="label__"+a,i=document.getElementById(o).cloneNode(!0),i.name="label__"+e,i.id="label__"+e,i.value="",n.appendChild(i),c=document.createElement("textNode"),c.innerHTML=":&nbsp;",n.appendChild(c),r="label_value__"+a,l=document.getElementById(r).cloneNode(!0),l.name="label_value__"+e,l.id="label_value__"+e,l.value="",n.appendChild(l),d=document.getElementById("addLabel"),t.removeChild(d),s=e+1,u="addLabel("+s+")",d.setAttribute("onclick",u),t.appendChild(d),m=document.getElementById("number_of_labels"),m.value=parseInt(m.value)+1}function saveAgentRank(){$.getJSON("/component/functions.cfc",{method:"saveAgentRank",agent_id:$("#agent_id").val(),agent_rank:$("#agent_rank").val(),remark:$("#remark").val(),transaction_type:$("#transaction_type").val(),returnformat:"json",queryformat:"column"},function(e){if(e.length>0&&"fail"==e.substring(0,4))alert(e);else{var t='<tr id="tablr'+e+'"><td>'+$("#agent_rank").val()+"</td>";t+="<td>"+$("#transaction_type").val()+"</td>",t+="<td>- just now - </td>",t+='<td>- you - <span class="infoLink" onclick="revokeAgentRank(\''+e+"');\">revoke</span></td>",t+="<td>"+$("#remark").val()+"</td></tr>",$("#agntRankTbl").append(t)}})}function revokeAgentRank(e){$.getJSON("/component/functions.cfc",{method:"revokeAgentRank",agent_rank_id:e,returnformat:"json",queryformat:"column"},function(t){t.length>0&&"fail"==t.substring(0,4)?alert(t):$("#tablr"+e).remove()})}function removeMediaMultiCatItem(){$("#bgDiv").remove(),$("#pickFrame").remove()}function manyCatItemToMedia(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",t.setAttribute("onclick","removeMediaMultiCatItem()"),document.body.appendChild(t);var n="/includes/forms/manyCatItemToMedia.cfm?media_id="+e;$('<iframe id="pickFrame" name="pickFrame" class="pickDiv" src="'+n+'">').appendTo("body")}function pickThis(e,t,n,a){document.getElementById(e).value=n,document.getElementById(t).value=a,document.getElementById(e).className="goodPick",removePick()}function removePick(){document.getElementById("pickDiv")&&$("#pickDiv").remove(),removeBgDiv()}function addBGDiv(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",(null===e||0===e.length)&&(e="removeBgDiv()"),t.setAttribute("onclick",e),document.body.appendChild(t)}function removeBgDiv(){document.getElementById("bgDiv")&&$("#bgDiv").remove()}function deleteAgent(e){$("#author_name"+e).addClass("red").val("deleted"),$("#authortr"+e+" td:nth-child(1)").addClass("red"),$("#authortr"+e+" td:nth-child(3)").addClass("red")}$.datepicker.setDefaults({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,constrainInput:!1}),$(document).ready(function(){$(".helpLink").live("click",function(e){var t=this.id;removeHelpDiv();var n=document.createElement("div");n.id="bgDiv",n.className="bgDiv",n.setAttribute("onclick","removeHelpDiv()"),document.body.appendChild(n);var a=document.createElement("div");a.id="helpDiv",a.className="helpBox",a.innerHTML="<br>Loading...",document.body.appendChild(a),$("#helpDiv").css({position:"absolute",top:e.pageY,left:e.pageX}),$(a).load("/doc/get_short_doc.cfm",{fld:t,addCtl:1})}),$("#c_identifiers_cust").click(function(){var e=document.createElement("div");e.id="bgDiv",e.className="bgDiv",e.setAttribute("onclick","closeAndRefresh()"),document.body.appendChild(e);var t=document.createElement("div");t.id="customDiv",t.className="sscustomBox",t.innerHTML="<br>Loading...",document.body.appendChild(t);var n="/includes/SpecSearch/customIDs.cfm";$(t).load(n,{},function(){})}),self!=top&&null!=parent&&parent.frames[0].thisStyle&&changeStyle(parent.frames[0].thisStyle),$("input[type='date'], input[type='datetime']").datepicker()}),$("#uploadMedia").live("click",function(){addBGDiv("removeUpload()");var e=document.createElement("iFrame");e.id="uploadDiv",e.className="uploadMediaDiv",e.innerHTML="<br>Loading...",document.body.appendChild(e);var t="/info/upMedia.cfm";e.src=t}),function(e){e.fn.superfish=function(t){var n=e.fn.superfish,a=n.c,o=e(['<span class="',a.arrowClass,'"> &#187;</span>'].join("")),i=function(){var t=e(this),n=c(t);clearTimeout(n.sfTimer),t.showSuperfishUl().siblings().hideSuperfishUl()},r=function(){var t=e(this),a=c(t),o=n.op;clearTimeout(a.sfTimer),a.sfTimer=setTimeout(function(){o.retainPath=e.inArray(t[0],o.$path)>-1,t.hideSuperfishUl(),o.$path.length&&t.parents(["li.",o.hoverClass].join("")).length<1&&i.call(o.$path)},o.delay)},c=function(e){var t=e.parents(["ul.",a.menuClass,":first"].join(""))[0];return n.op=n.o[t.serial],t},l=function(e){e.addClass(a.anchorClass).append(o.clone())};return this.each(function(){var o=this.serial=n.o.length,c=e.extend({},n.defaults,t);c.$path=e("li."+c.pathClass,this).slice(0,c.pathLevels).each(function(){e(this).addClass([c.hoverClass,a.bcClass].join(" ")).filter("li:has(ul)").removeClass(c.pathClass)}),n.o[o]=n.op=c,e("li:has(ul)",this)[e.fn.hoverIntent&&!c.disableHI?"hoverIntent":"hover"](i,r).each(function(){c.autoArrows&&l(e(">a:first-child",this))}).not("."+a.bcClass).hideSuperfishUl();var d=e("a",this);d.each(function(e){var t=d.eq(e).parents("li");d.eq(e).focus(function(){i.call(t)}).blur(function(){r.call(t)})}),c.onInit.call(this)}).each(function(){var t=[a.menuClass];!n.op.dropShadows||e.browser.msie&&e.browser.version<7||t.push(a.shadowClass),e(this).addClass(t.join(" "))})};var t=e.fn.superfish;t.o=[],t.op={},t.IE7fix=function(){var n=t.op;e.browser.msie&&e.browser.version>6&&n.dropShadows&&void 0!==n.animation.opacity&&this.toggleClass(t.c.shadowClass+"-off")},t.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"},t.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},speed:"normal",autoArrows:!0,dropShadows:!0,disableHI:!1,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}},e.fn.extend({hideSuperfishUl:function(){var n=t.op,a=n.retainPath===!0?n.$path:"";n.retainPath=!1;var o=e(["li.",n.hoverClass].join(""),this).add(this).not(a).removeClass(n.hoverClass).find(">ul").hide().css("visibility","hidden");return n.onHide.call(o),this},showSuperfishUl:function(){var e=t.op,n=(t.c.shadowClass+"-off",this.addClass(e.hoverClass).find(">ul:hidden").css("visibility","visible"));return t.IE7fix.call(n),e.onBeforeShow.call(n),n.animate(e.animation,e.speed,function(){t.IE7fix.call(n),e.onShow.call(n)}),this}})}($),function(e){e.fn.supersubs=function(t){var n=e.extend({},e.fn.supersubs.defaults,t);return this.each(function(){var t=e(this),a=e.meta?e.extend({},n,t.data()):n,o=e('<li id="menu-fontsize">&#8212;</li>').css({padding:0,position:"absolute",top:"-999em",width:"auto"}).appendTo(t).width();e("#menu-fontsize").remove(),$ULs=t.find("ul"),$ULs.each(function(t){var n=$ULs.eq(t),i=n.children(),r=i.children("a"),c=i.css("white-space","nowrap").css("float"),l=n.add(i).add(r).css({"float":"none",width:"auto"}).end().end()[0].clientWidth/o;l+=a.extraWidth,l>a.maxWidth?l=a.maxWidth:l<a.minWidth&&(l=a.minWidth),l+="em",n.css("width",l),i.css({"float":c,width:"100%","white-space":"normal"}).each(function(){var t=e(">ul",this),n=void 0!==t.css("left")?"left":"right";t.css(n,l)})})})},e.fn.supersubs.defaults={minWidth:9,maxWidth:25,extraWidth:0}}($),function(e){e.fn.hoverIntent=function(t,n){var a={sensitivity:7,interval:100,timeout:0};a=e.extend(a,n?{over:t,out:n}:t);var o,i,r,c,l=function(e){o=e.pageX,i=e.pageY},d=function(t,n){return n.hoverIntent_t=clearTimeout(n.hoverIntent_t),Math.abs(r-o)+Math.abs(c-i)<a.sensitivity?(e(n).unbind("mousemove",l),n.hoverIntent_s=1,a.over.apply(n,[t])):(r=o,c=i,n.hoverIntent_t=setTimeout(function(){d(t,n)},a.interval),void 0)},s=function(e,t){return t.hoverIntent_t=clearTimeout(t.hoverIntent_t),t.hoverIntent_s=0,a.out.apply(t,[e])},u=function(t){for(var n=("mouseover"==t.type?t.fromElement:t.toElement)||t.relatedTarget;n&&n!=this;)try{n=n.parentNode}catch(t){n=this}if(n==this)return!1;var o=e.extend({},t),i=this;i.hoverIntent_t&&(i.hoverIntent_t=clearTimeout(i.hoverIntent_t)),"mouseover"==t.type?(r=o.pageX,c=o.pageY,e(i).bind("mousemove",l),1!=i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){d(o,i)},a.interval))):(e(i).unbind("mousemove",l),1==i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){s(o,i)},a.timeout)))};return this.mouseover(u).mouseout(u)}}($);