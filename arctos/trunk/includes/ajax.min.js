function op_getAgent(e,t,n){$("#"+t).removeClass("goodPick");var r="/picks/op_findAgent.cfm";var n;r+="?agentIdID="+e+"&agentNameID="+t+"&agent_name="+n;$.colorbox({width:"80%",height:"80%",href:r})}function checkCSV(e){var t=e.value;var n=t.substring(t.lastIndexOf(".")+1).toLowerCase();if(n!="csv"){alert("Only files with the file extension CSV are allowed");$("input[type=submit]").hide()}else{$("input[type=submit]").show()}}function getMedia(e,t,n,r,i){$("#imgBrowserCtlDiv").append('<img src="/images/indicator.gif">');var e;var t;var n;var r;var i;var s="/form/inclMedia.cfm?typ="+e+"&q="+t+"&tgt="+n+"&rpp="+r+"&pg="+i;jQuery.get(s,function(e){jQuery("#"+n).html(e)})}function blockSuggest(e){$.getJSON("/component/functions.cfc",{method:"changeBlockSuggest",onoff:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){$("#browseArctos").html("Suggest Browser disabled. You may turn this feature back on under My Stuff.")}else{alert("An error occured! \n "+e)}})}function changekillRows(e){jQuery.getJSON("/component/functions.cfc",{method:"changekillRows",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e!="success"){alert("An error occured: "+e)}})}function findPart(e,t,n){var r="/picks/findPart.cfm";var t=t.replace("%","_");var i=r+"?part_name="+t+"&collCde="+n+"&partFld="+e;partpick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function isValidEmailAddress(e){var t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return t.test(e)}function saveThisAnnotation(){var e=document.getElementById("idtype").value;var t=document.getElementById("idvalue").value;var n=document.getElementById("annotation").value;var r=$("#captchaHash").val();var i=$("#captcha").val().toUpperCase();if(n.length<=20){alert("You must enter an annotation of at least 20 characters to save.");return false}if(!isValidEmailAddress($("#email").val())){alert("Enter a valid email address.");return false}$.getJSON("/component/functions.cfc",{method:"hashString",string:i,returnformat:"json"},function(i){if(i!=r){alert("bad captcha");return false}$.getJSON("/component/functions.cfc",{method:"addAnnotation",idType:e,idvalue:t,annotation:n,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){closeAnnotation();alert("Your annotations have been saved, and the appropriate curator will be alerted. \n Thank you for helping improve Arctos!")}else{alert("An error occured! \n "+e)}})})}function openAnnotation(e){var t=document.createElement("div");t.id="bgDiv";t.className="bgDiv";t.setAttribute("onclick","closeAnnotation()");document.body.appendChild(t);var n=document.createElement("div");n.id="annotateDiv";n.className="annotateBox";n.innerHTML="";n.src="";document.body.appendChild(n);var r="/info/annotate.cfm?q="+e;jQuery("#annotateDiv").load(r,{},function(){viewport.init("#annotateDiv")})}function npPage(e,t,n){var r="/includes/taxonomy/specTaxMedia.cfm";var i="?Result_Per_Page="+t+"&offset="+e+"&taxon_name_id="+n;r+=i;$("#imgBrowserCtlDiv").append('<img src="/images/indicator.gif">');jQuery.get(r,function(e){jQuery("#specTaxMedia").html(e)})}function closeAnnotation(){var e=document.getElementById("bgDiv");document.body.removeChild(e);var e=document.getElementById("annotateDiv");document.body.removeChild(e)}function saveSearch(e){var t=Date.now();var n=prompt("Name your saved search. \n  Copy and paste the suggestion or type your own (unique) search name.\n  Manage or email saved searches from your profile.",t);if(n!==null){var r=encodeURIComponent(n);var i=encodeURI(e);jQuery.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:i,srchName:r,returnformat:"json",queryformat:"column"},function(e){if(e!="success"){alert(e)}})}}function success_crcloo(){return false}function crcloo(e,t){jQuery.getJSON("/component/functions.cfc",{method:"clientResultColumnList",ColumnList:e,in_or_out:t,returnformat:"json",queryformat:"column"},success_crcloo)}function checkAllById(e){var t=e.split(",");for(i=0;i<t.length;++i){if(document.getElementById(t[i])){document.getElementById(t[i]).checked=true;crcloo(t[i],"in")}}}function uncheckAllById(e){crcloo(e,"out");var t=e.split(",");for(i=0;i<t.length;++i){if(document.getElementById(t[i])){document.getElementById(t[i]).checked=false}}}function goPickParts(e,t){var n="/picks/internalAddLoanItemTwo.cfm?collection_object_id="+e+"&transaction_id="+t;mywin=windowOpener(n,"myWin","height=300,width=800,resizable,location,menubar ,scrollbars ,status ,titlebar,toolbar")}function hidePageLoad(){$("#loading").hide()}function findAccession(){var e=document.getElementById("collection_id").value;var t=document.getElementById("accn_number").value;jQuery.getJSON("/component/functions.cfc",{method:"findAccession",collection_id:e,accn_number:t,returnformat:"json",queryformat:"column"},success_findAccession)}function success_findAccession(e){if(e>0){document.getElementById("g_num").className="doShow";document.getElementById("b_num").className="noShow"}else{document.getElementById("g_num").className="noShow";document.getElementById("b_num").className="doShow"}}function addPartToContainer(){document.getElementById("pTable").className="red";var e=document.getElementById("collection_object_id").value;var t=document.getElementById("part_name").value;var n=document.getElementById("part_name_2").value;var r=document.getElementById("parent_barcode").value;var i=document.getElementById("new_container_type").value;if(e.length==0||t.length==0||r.length==0){alert("Something is null");return false}jQuery.getJSON("/component/functions.cfc",{method:"addPartToContainer",collection_object_id:e,part_id:t,part_id2:n,parent_barcode:r,new_container_type:i,returnformat:"json",queryformat:"column"},success_addPartToContainer)}function success_addPartToContainer(e){statAry=e.split("|");var t=statAry[0];var n=statAry[1];document.getElementById("pTable").className="";var r=document.getElementById("msgs");var i=document.getElementById("msgs_hist");var s=r.innerHTML+"<hr>"+i.innerHTML;i.innerHTML=s;r.innerHTML=n;if(t==0){r.className="error"}else{r.className="successDiv";document.getElementById("oidnum").focus();document.getElementById("oidnum").select();getParts()}}function clonePart(){var e=document.getElementById("collection_id").value;var t=document.getElementById("other_id_type").value;var n=document.getElementById("oidnum").value;if(e.length>0&&t.length>0&&n.length>0){jQuery.getJSON("/component/functions.cfc",{method:"getSpecimen",collection_id:e,other_id_type:t,oidnum:n,returnformat:"json",queryformat:"column"},success_getSpecimen)}else{alert("Error: cannot resolve ID to specimen.")}}function success_getSpecimen(e){if(toString(e.DATA.COLLECTION_OBJECT_ID[0]).indexOf("Error:")>-1){alert(e.DATA.COLLECTION_OBJECT_ID[0])}else{newPart(e.DATA.COLLECTION_OBJECT_ID[0])}}function checkSubmit(){var e=document.getElementById("submitOnChange").checked;if(e==true){addPartToContainer()}}function newPart(e){var t=document.getElementById("collection_id").value;var n=document.getElementById("part_name").value;var r="/form/newPart.cfm";r+="?collection_id="+t;r+="&collection_object_id="+e;r+="&part="+n;divpop(r)}function getParts(){var e=document.getElementById("collection_id").value;var t=document.getElementById("other_id_type").value;var n=document.getElementById("oidnum").value;if(e.length>0&&t.length>0&&n.length>0){var r=document.createElement("DIV");r.id="ajaxStatus";r.className="ajaxStatus";r.innerHTML="Fetching parts...";document.body.appendChild(r);var i=document.getElementById("noBarcode").checked;var s=document.getElementById("noSubsample").checked;jQuery.getJSON("/component/functions.cfc",{method:"getParts",collection_id:e,other_id_type:t,oidnum:n,noBarcode:i,noSubsample:s,returnformat:"json",queryformat:"column"},success_getParts)}}function success_getParts(e){var t=e.DATA;var n=document.getElementById("ajaxStatus");document.body.removeChild(n);var r=document.getElementById("thisSpecimen");var s=document.getElementById("collection_id");var o=document.getElementById("collection_object_id");var u=document.getElementById("part_name");var a=document.getElementById("part_name_2");var f=u.value;var l=a.value;u.options.length=0;a.options.length=0;var c=s.selectedIndex;var h=s.options[c].text;var p=document.getElementById("other_id_type").value;var d=document.getElementById("oidnum").value;var v=h+" "+p+" "+d;if(t.PART_NAME[0].indexOf("Error:")>-1){r.className="error";v+=" = "+t.PART_NAME[0];o.value="";document.getElementById("pTable").className="red"}else{document.getElementById("pTable").className="";r.className="";o.value=t.COLLECTION_OBJECT_ID[0];var m=document.createElement("option");m.setAttribute("value","");m.appendChild(document.createTextNode(""));a.appendChild(m);for(i=0;i<e.ROWCOUNT;i++){var m=document.createElement("option");var g=document.createElement("option");m.setAttribute("value",t.PARTID[i]);g.setAttribute("value",t.PARTID[i]);var y=t.PART_NAME[i];if(t.BARCODE[i]!==null){y+=" ["+t.BARCODE[i]+"]"}m.appendChild(document.createTextNode(y));g.appendChild(document.createTextNode(y));u.appendChild(m);a.appendChild(g)}u.value=f;a.value=l;v+=" = "+t.COLLECTION[0]+" "+t.CAT_NUM[0]+" ("+t.CUSTOMIDTYPE[0]+" "+t.CUSTOMID[0]+")"}r.innerHTML=v}function divpop(e){var t;var n=document.createElement("div");n.id="bgDiv";n.className="bgDiv";document.body.appendChild(n);var r=document.createElement("div");r.id="ppDiv";r.className="pickBox";r.innerHTML="Loading....";r.src="";document.body.appendChild(r);if(window.XMLHttpRequest){t=new XMLHttpRequest}else if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLHTTP")}if(t!=undefined){t.onreadystatechange=function(){divpopDone(t)};t.open("GET",e,true);t.send("")}}function divpopDone(e){if(e.readyState==4){if(e.status==200){document.getElementById("ppDiv").innerHTML=e.responseText}else{document.getElementById("ppDiv").innerHTML="ahah error:\n"+e.statusText}var t=document.getElementById("ppDiv");var n=document.createElement("span");n.className="popDivControl";n.setAttribute("onclick","divpopClose();");n.innerHTML="X";t.appendChild(n)}}function divpopClose(){var e=document.getElementById("ppDiv");document.body.removeChild(e);var t=document.getElementById("bgDiv");document.body.removeChild(t)}function makePart(){var e=document.getElementById("collection_object_id").value;var t=document.getElementById("npart_name").value;var n=document.getElementById("lot_count").value;var r=document.getElementById("coll_obj_disposition").value;var i=document.getElementById("condition").value;var s=document.getElementById("coll_object_remarks").value;var o=document.getElementById("barcode").value;var u=document.getElementById("new_container_type").value;jQuery.getJSON("/component/functions.cfc",{method:"makePart",collection_object_id:e,part_name:t,lot_count:n,coll_obj_disposition:r,condition:i,coll_object_remarks:s,barcode:o,new_container_type:u,returnformat:"json",queryformat:"column"},function(e){var t=e.DATA;var n=t.STATUS[0];if(n=="error"){var r=t.MSG[0];alert(r)}else{var r="Created part: ";r+=t.PART_NAME[0]+" ";if(t.BARCODE[0]!==null){r+="barcode "+t.BARCODE[0];if(t.NEW_CONTAINER_TYPE[0]!==null){r+="( "+t.NEW_CONTAINER_TYPE[0]+")"}}var i=document.getElementById("ppDiv");document.body.removeChild(i);var s=document.getElementById("bgDiv");document.body.removeChild(s);getParts()}})}function changeresultSort(e){jQuery.getJSON("/component/functions.cfc",{method:"changeresultSort",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){var t=document.getElementById("result_sort").className=""}else{alert("An error occured: "+e)}})}function changedisplayRows(e){jQuery.getJSON("/component/functions.cfc",{method:"changedisplayRows",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){document.getElementById("displayRows").className=""}else{alert("An error occured: "+e)}})}function getAgentInfo(e){removeHelpDiv();var t=document.createElement("div");t.id="bgDiv";t.className="bgDiv";t.setAttribute("onclick","removeHelpDiv()");document.body.appendChild(t);var n=document.createElement("div");n.id="helpDiv";n.className="helpBox centered";n.innerHTML='<img src="/images/indicator.gif" style="margin:5em;">';document.body.appendChild(n);jQuery(n).load("/ajax/agentInfo.cfm",{agent_id:e,addCtl:1})}function scrollToAnchor(e){var t=$("a[name='"+e+"']");$("html,body").animate({scrollTop:t.offset().top},"slow")}function changefancyCOID(e){jQuery.getJSON("/component/functions.cfc",{method:"changefancyCOID",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){var t=document.getElementById("fancyCOID").className=""}else{alert("An error occured: "+e)}})}function changecustomOtherIdentifier(e){jQuery.getJSON("/component/functions.cfc",{method:"changecustomOtherIdentifier",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){document.getElementById("customOtherIdentifier").className=""}else{alert("An error occured: "+e)}})}function removeHelpDiv(){if(document.getElementById("bgDiv")){jQuery("#bgDiv").remove()}if(document.getElementById("helpDiv")){jQuery("#helpDiv").remove()}}function changeshowObservations(e){jQuery.getJSON("/component/functions.cfc",{method:"changeshowObservations",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e!="success"){alert("An error occured: "+e)}})}function saveComplete(e){var t=e.split(",");var n=t[0];var r=t[1];var s=t[2];if(n=="cookie"){var o=new Array;var u=readCookie("specsrchprefs");var a=-1;if(u!==null){o=u.split(",");for(i=0;i<o.length;i++){if(o[i]==r){a=i}}}if(s==1){if(a==-1){o.push(r)}}else{if(a!=-1)o.splice(a,1)}var f=o.join();createCookie("specsrchprefs",f,0)}}function saveSpecSrchPref(e,t){jQuery.getJSON("/component/functions.cfc",{method:"saveSpecSrchPref",id:e,onOff:t,returnformat:"json",queryformat:"column"},saveComplete)}function showHide(e,t){var n="e_"+e;var r="c_"+e;if(document.getElementById(n)&&document.getElementById(r)){var i=document.getElementById(n);var s=document.getElementById(r);if(n=="e_spatial_query"){var o="Select on Google Map";var u="Hide Google Map"}else{var u="Show Fewer Options";var o="Show More Options"}if(t==1){var a="/includes/SpecSearch/"+e+".cfm";s.innerHTML='<img src="/images/indicator.gif">';jQuery.get(a,function(n){jQuery(i).html(n);s.innerHTML=u;s.setAttribute("onclick","showHide('"+e+"',0)");saveSpecSrchPref(e,t)})}else{i.innerHTML="";s.setAttribute("onclick","showHide('"+e+"',1)");s.innerHTML=o;saveSpecSrchPref(e,t)}}}function closeAndRefresh(){document.location=location.href;var e=document.getElementById("customDiv");document.body.removeChild(e)}function getFormValues(){var e=document.getElementById("SpecData");var t=e.length;var n=new Array;for(var r=0;r<t;r++){var i=e.elements[r];var s=i.name;var o=i.value;if(s.length>0&&o.length>0&&s!="selectedCoords"){var u=s+"::"+String(o);if(n.indexOf(u)==-1){n.push(u)}}}var a=n.join("|");document.cookie="schParams="+a}function nada(){return false}function createCookie(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function readCookie(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function changeexclusive_collection_id(e){jQuery.getJSON("/component/functions.cfc",{method:"changeexclusive_collection_id",tgt:e,returnformat:"json",queryformat:"column"},function(e){if(e=="success"){var t=document.getElementById("exclusive_collection_id").className=""}else{alert("An error occured: "+e)}})}function IsNumeric(e){var t="0123456789.";var n=true;var r;for(i=0;i<e.length&&n==true;i++){r=e.charAt(i);if(t.indexOf(r)==-1){n=false}}return n}function get_cookie(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");if(t)return unescape(t[2]);else return null}function orapwCheck(e,t){var n=/^[A-Za-z0-9!$%&_?(\-)<>=/:;*\.]$/;var r=6;var i="Password is acceptable";if(e.indexOf(t)>-1){i="Password may not contain your username."}if(e.length<r||e.length>30){i="Password must be between "+r+" and 30 characters."}if(!e.match(/[a-zA-Z]/)){i="Password must contain at least one letter."}if(!e.match(/\d+/)){i="Password must contain at least one number."}if(!e.match(/[!,$,%,&,*,?,_,-,(,),<,>,=,/,:,;,.]/)){i="Password must contain at least one of: !,$,%,&,*,?,_,-,(,),<,>,=,/,:,;."}for(var s=0;s<e.length;s++){if(!e.charAt(s).match(n)){i="Password may contain only A-Z, a-z, 0-9, and !$%&()`*+,-/:;<=>?_."}}return i}function getCtDoc(e,t){var e;var t;var n="/info/ctDocumentation.cfm?table="+e+"&field="+t;ctDocWin=windowOpener(n,"ctDocWin","width=700,height=400, resizable,scrollbars")}function windowOpener(e,t,n){popupWins=[];if(typeof popupWins[t]!="object"){popupWins[t]=window.open(e,t,n)}else{if(!popupWins[t].closed){popupWins[t].location.href=e}else{popupWins[t]=window.open(e,t,n)}}popupWins[t].focus()}function getDocs(e,t){var e;var t;jQuery.getJSON("/component/functions.cfc",{method:"get_docs",uri:e,anchor:t,returnformat:"json"},function(e){if(e=="404"){alert("help not found.")}else{siteHelpWin=windowOpener(e,"HelpWin","width=800,height=600, resizable,scrollbars,location,toolbar")}})}function noenter(e){var t;if(window.event)t=window.event.keyCode;else t=e.which;if(t==13)return false;else return true}function gotAgentId(e){var e;var t=e.length;if(t==0){alert("Oops! A select box malfunctioned! Try changing the value and leaving with TAB. The background should change to green when you've successfullly run the check routine.");return false}}function chgCondition(e){var e;helpWin=windowOpener("/picks/condition.cfm?collection_object_id="+e,"conditionWin","width=800,height=338, resizable,scrollbars")}function getLoan(e,t,n,r){var i="/picks/getLoan.cfm";var e;var t;var n;var r;var s=i+"?LoanIDFld="+e+"&LoanNumberFld="+t+"&loanNumber="+n+"&agent_name="+r;loanpickwin=window.open(s,"","width=400,height=338, resizable,scrollbars")}function getAgent(e,t,n,r,i){var s="/picks/findAgent.cfm";var e;var t;var n;var r;var i;var o=s+"?agentIdFld="+e+"&agentNameFld="+t+"&formName="+n+"&agent_name="+r+"&allowCreation="+i;agentpickwin=window.open(o,"","width=400,height=338, resizable,scrollbars")}function getProject(e,t,n,r){var i="/picks/findProject.cfm";var e;var t;var n;var r;var s=i+"?projIdFld="+e+"&projNameFld="+t+"&formName="+n+"&project_name="+r;projpickwin=window.open(s,"","width=400,height=338, resizable,scrollbars")}function findCatalogedItem(e,t,n,r,i,s){var o="/picks/findCatalogedItem.cfm";var e;var u;var n;var r;var i;var a;var f=o+"?collIdFld="+e+"&CatNumStrFld="+t+"&formName="+n+"&oidType="+r+"&oidNum="+i+"&collID="+s;catItemWin=window.open(f,"","width=400,height=338, resizable,scrollbars")}function findCollEvent(e,t,n,r){var i="/picks/findCollEvent.cfm";var s=i+"?collIdFld="+e+"&dispField="+n+"&formName="+t+"&collecting_event_name="+r;ColPickwin=window.open(s,"","width=800,height=600, resizable,scrollbars")}function getPublication(e,t,n,r){var i="/picks/findPublication.cfm";var s=i+"?pubStringFld="+e+"&pubIdFld="+t+"&publication_title="+n+"&formName="+r;s=window.open(s,"","width=400,height=338, resizable,scrollbars")}function getAccn(e,t,n){var r="/picks/findAccn.cfm";var i=r+"?r_accnNumber="+e+"&rtnFldID="+t+"&r_InstAcrColnCde="+n;i=window.open(i,"","width=400,height=338, resizable,scrollbars")}function getAccnMedia(e,t){var n="/picks/getAccnMedia.cfm";var r=n+"?idOfTxtFld="+e+"&idOfPKeyFld="+t;r=window.open(r,"","width=400,height=338, resizable,scrollbars")}function getAccn2(e,t){var n="/picks/getAccn.cfm";var r=n+"?accnNumber="+e+"&collectionID="+t;r=window.open(r,"","width=400,height=338, resizable,scrollbars")}function getGeog(e,t,n,r){var i="/picks/findHigherGeog.cfm";var e;var t;var n;var r;var s=i+"?geogIdFld="+e+"&geogStringFld="+t+"&formName="+n+"&geogString="+r;geogpickwin=window.open(s,"","width=400,height=338, resizable,scrollbars")}function confirmDelete(formName,msg){var formName;var msg=msg||"this record";var yesno=confirm("Are you sure you want to delete "+msg+"?");if(yesno==true){var txtstrng="document."+formName+".submit();";eval(txtstrng)}else{return false}}function getHistory(e){var t;historyWin=windowOpener("/info/ContHistory.cfm?container_id="+e,"historyWin","width=800,height=600, resizable,scrollbars")}function getQuadHelp(){helpWin=windowOpener("/info/quad.cfm","quadHelpWin","width=800,height=600, resizable,scrollbars,status")}function getLegal(e){var e;helpWin=windowOpener("/info/legal.cfm?content="+e,"legalWin","width=400,height=338, resizable,scrollbars")}function getInfo(e,t){var e;var t;infoWin=windowOpener("/info/SpecInfo.cfm?subject="+e+"&thisId="+t,"infoWin","width=800,height=500, resizable,scrollbars")}function addLoanItem(e){var e;loanItemWin=windowOpener("/user/loanItem.cfm?collection_object_id="+e,"loanItemWin","width=800,height=500, resizable,scrollbars,toolbar,menubar")}function findMedia(e,t,n){var r="/picks/findMedia.cfm";var t;var e;var n;var i=r+"?mediaIdFld="+t+"&mediaStringFld="+e+"&media_uri="+n;mediapick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function taxaPick(e,t,n,r){var i="/picks/TaxaPick.cfm";var e;var t;var n;var r;var s=i+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+n+"&scientific_name="+r;taxapick=window.open(s,"","width=400,height=338, resizable,scrollbars")}function taxaPickIdentification(e,t,n,r){var i="/picks/TaxaPickIdentification.cfm";var e;var t;var n;var r;var s=i+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+n+"&scientific_name="+r;taxapick=window.open(s,"","width=400,height=338, resizable,scrollbars")}function CatItemPick(e,t,n,r){var i="/picks/CatalogedItemPick.cfm";var e;var t;var n;var r;var s=i+"?collIdFld="+e+"&catNumFld="+t+"&formName="+n+"&sciNameFld="+r;CatItemPick=window.open(s,"","width=400,height=338, resizable,scrollbars")}function findAgentName(e,t,n){var r="/picks/findAgentName.cfm";var e;var t;var n;var i=r+"?agentIdFld="+e+"&agentNameFld="+t+"&agentName="+n;agentpick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function addrPick(e,t,n){var r="/picks/AddrPick.cfm";var e;var t;var n;var i=r+"?addrIdFld="+e+"&addrFld="+t+"&formName="+n;addrpick=window.open(i,"","width=400,height=338, resizable,scrollbars")}function GeogPick(e,t,n){var r="/picks/GeogPick.cfm";var e;var t;var n;var i=r+"?geogIdFld="+e+"&highGeogFld="+t+"&formName="+n;geogpick=window.open(i,"","width=600,height=600, toolbar,resizable,scrollbars,")}function LocalityPick(e,t,n,r){var i="/picks/LocalityPick.cfm";var e;var t;var n;var s;var o=i+"?localityIdFld="+e+"&speclocFld="+t+"&formName="+n+"&locality_name="+r;localitypick=window.open(o,"","width=800,height=600,resizable,scrollbars,")}function findJournal(e,t,n,r){var i="/picks/findJournal.cfm";var e;var t;var n;var r;var s=i+"?journalIdFld="+e+"&journalNameFld="+t+"&formName="+n+"&journalName="+r;journalpick=window.open(s,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function deleteEncumbrance(e,t){var n="/picks/DeleteEncumbrance.cfm";var e;var t;var r=n+"?encumbrance_id="+e+"&collection_object_id="+t;deleteEncumbrance=window.open(r,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function getAllSheets(){if(!window.ScriptEngine&&navigator.__ice_version){return document.styleSheets}if(document.getElementsByTagName){var e=document.getElementsByTagName("LINK");var t=document.getElementsByTagName("STYLE")}else if(document.styleSheets&&document.all){var e=document.all.tags("LINK"),t=document.all.tags("STYLE")}else{return[]}for(var n=0,r=[];e[n];n++){if(e[n].rel){var i=e[n].rel}else if(e[n].getAttribute){var i=e[n].getAttribute("rel")}else{var i=""}if(typeof i=="string"&&i.toLowerCase().indexOf("style")+1){r[r.length]=e[n]}}for(var n=0;t[n];n++){r[r.length]=t[n]}return r}function changeStyle(){for(var e=0,t=getAllSheets();t[e];e++){if(t[e].title){t[e].disabled=true}for(var n=0;n<arguments.length;n++){if(t[e].title==arguments[n]){t[e].disabled=false}}}if(!t.length){alert("Your browser cannot change stylesheets")}}var viewport={o:function(){if(self.innerHeight){this.pageYOffset=self.pageYOffset;this.pageXOffset=self.pageXOffset;this.innerHeight=self.innerHeight;this.innerWidth=self.innerWidth}else if(document.documentElement&&document.documentElement.clientHeight){this.pageYOffset=document.documentElement.scrollTop;this.pageXOffset=document.documentElement.scrollLeft;this.innerHeight=document.documentElement.clientHeight;this.innerWidth=document.documentElement.clientWidth}else if(document.body){this.pageYOffset=document.body.scrollTop;this.pageXOffset=document.body.scrollLeft;this.innerHeight=document.body.clientHeight;this.innerWidth=document.body.clientWidth}return this},init:function(e){jQuery(e).css("left",Math.round(viewport.o().innerWidth/2)+viewport.o().pageXOffset-Math.round(jQuery(e).width()/2));jQuery(e).css("top",Math.round(viewport.o().innerHeight/2)+viewport.o().pageYOffset-Math.round(jQuery(e).height()/2))}};var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,r=function(e,t){e=String(e);t=t||2;while(e.length<t)e="0"+e;return e};return function(i,s,o){var u=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){s=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i))throw SyntaxError("invalid date");s=String(u.masks[s]||s||u.masks["default"]);if(s.slice(0,4)=="UTC:"){s=s.slice(4);o=true}var a=o?"getUTC":"get",f=i[a+"Date"](),l=i[a+"Day"](),c=i[a+"Month"](),h=i[a+"FullYear"](),p=i[a+"Hours"](),d=i[a+"Minutes"](),v=i[a+"Seconds"](),m=i[a+"Milliseconds"](),g=o?0:i.getTimezoneOffset(),y={d:f,dd:r(f),ddd:u.i18n.dayNames[l],dddd:u.i18n.dayNames[l+7],m:c+1,mm:r(c+1),mmm:u.i18n.monthNames[c],mmmm:u.i18n.monthNames[c+12],yy:String(h).slice(2),yyyy:h,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),M:d,MM:r(d),s:v,ss:r(v),l:r(m,3),L:r(m>99?Math.round(m/10):m),t:p<12?"a":"p",tt:p<12?"am":"pm",T:p<12?"A":"P",TT:p<12?"AM":"PM",Z:o?"UTC":(String(i).match(t)||[""]).pop().replace(n,""),o:(g>0?"-":"+")+r(Math.floor(Math.abs(g)/60)*100+Math.abs(g)%60,4),S:["th","st","nd","rd"][f%10>3?0:(f%100-f%10!=10)*f%10]};return s.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(e,t){return dateFormat(this,e,t)};jQuery(document).ready(function(){jQuery(".helpLink").live("click",function(e){var t=this.id;removeHelpDiv();var n=document.createElement("div");n.id="bgDiv";n.className="bgDiv";n.setAttribute("onclick","removeHelpDiv()");document.body.appendChild(n);var r=document.createElement("div");r.id="helpDiv";r.className="helpBox";r.innerHTML="<br>Loading...";document.body.appendChild(r);jQuery("#helpDiv").css({position:"absolute",top:e.pageY,left:e.pageX});jQuery(r).load("/doc/get_short_doc.cfm",{fld:t,addCtl:1})});jQuery("#c_collection_cust").click(function(e){var t=document.createElement("div");t.id="bgDiv";t.className="bgDiv";t.setAttribute("onclick","closeAndRefresh()");document.body.appendChild(t);var n=document.createElement("div");n.id="customDiv";n.className="sscustomBox";n.innerHTML="<br>Loading...";document.body.appendChild(n);var r="/includes/SpecSearch/changeCollection.cfm";jQuery(n).load(r,{},function(){viewport.init("#customDiv")})});jQuery("#c_identifiers_cust").click(function(e){var t=document.createElement("div");t.id="bgDiv";t.className="bgDiv";t.setAttribute("onclick","closeAndRefresh()");document.body.appendChild(t);var n=document.createElement("div");n.id="customDiv";n.className="sscustomBox";n.innerHTML="<br>Loading...";document.body.appendChild(n);var r="/includes/SpecSearch/customIDs.cfm";jQuery(n).load(r,{},function(){viewport.init("#customDiv")})})});if(self!=top){if(parent.frames[0].thisStyle){changeStyle(parent.frames[0].thisStyle)}}(function(e){e.fn.superfish=function(t){var n=e.fn.superfish,r=n.c,i=e(['<span class="',r.arrowClass,'"> &#187;</span>'].join("")),s=function(){var t=e(this),n=u(t);clearTimeout(n.sfTimer);t.showSuperfishUl().siblings().hideSuperfishUl()},o=function(){var t=e(this),r=u(t),i=n.op;clearTimeout(r.sfTimer);r.sfTimer=setTimeout(function(){i.retainPath=e.inArray(t[0],i.$path)>-1;t.hideSuperfishUl();if(i.$path.length&&t.parents(["li.",i.hoverClass].join("")).length<1){s.call(i.$path)}},i.delay)},u=function(e){var t=e.parents(["ul.",r.menuClass,":first"].join(""))[0];n.op=n.o[t.serial];return t},a=function(e){e.addClass(r.anchorClass).append(i.clone())};return this.each(function(){var i=this.serial=n.o.length;var u=e.extend({},n.defaults,t);u.$path=e("li."+u.pathClass,this).slice(0,u.pathLevels).each(function(){e(this).addClass([u.hoverClass,r.bcClass].join(" ")).filter("li:has(ul)").removeClass(u.pathClass)});n.o[i]=n.op=u;e("li:has(ul)",this)[e.fn.hoverIntent&&!u.disableHI?"hoverIntent":"hover"](s,o).each(function(){if(u.autoArrows)a(e(">a:first-child",this))}).not("."+r.bcClass).hideSuperfishUl();var f=e("a",this);f.each(function(e){var t=f.eq(e).parents("li");f.eq(e).focus(function(){s.call(t)}).blur(function(){o.call(t)})});u.onInit.call(this)}).each(function(){var t=[r.menuClass];if(n.op.dropShadows&&!(e.browser.msie&&e.browser.version<7))t.push(r.shadowClass);e(this).addClass(t.join(" "))})};var t=e.fn.superfish;t.o=[];t.op={};t.IE7fix=function(){var n=t.op;if(e.browser.msie&&e.browser.version>6&&n.dropShadows&&n.animation.opacity!=undefined)this.toggleClass(t.c.shadowClass+"-off")};t.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"};t.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},speed:"normal",autoArrows:true,dropShadows:true,disableHI:false,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}};e.fn.extend({hideSuperfishUl:function(){var n=t.op,r=n.retainPath===true?n.$path:"";n.retainPath=false;var i=e(["li.",n.hoverClass].join(""),this).add(this).not(r).removeClass(n.hoverClass).find(">ul").hide().css("visibility","hidden");n.onHide.call(i);return this},showSuperfishUl:function(){var e=t.op,n=t.c.shadowClass+"-off",r=this.addClass(e.hoverClass).find(">ul:hidden").css("visibility","visible");t.IE7fix.call(r);e.onBeforeShow.call(r);r.animate(e.animation,e.speed,function(){t.IE7fix.call(r);e.onShow.call(r)});return this}})})(jQuery);(function(e){e.fn.supersubs=function(t){var n=e.extend({},e.fn.supersubs.defaults,t);return this.each(function(){var t=e(this);var r=e.meta?e.extend({},n,t.data()):n;var i=e('<li id="menu-fontsize">&#8212;</li>').css({padding:0,position:"absolute",top:"-999em",width:"auto"}).appendTo(t).width();e("#menu-fontsize").remove();$ULs=t.find("ul");$ULs.each(function(t){var n=$ULs.eq(t);var s=n.children();var u=s.children("a");var a=s.css("white-space","nowrap").css("float");var f=n.add(s).add(u).css({"float":"none",width:"auto"}).end().end()[0].clientWidth/i;f+=r.extraWidth;if(f>r.maxWidth){f=r.maxWidth}else if(f<r.minWidth){f=r.minWidth}f+="em";n.css("width",f);s.css({"float":a,width:"100%","white-space":"normal"}).each(function(){var t=e(">ul",this);var n=t.css("left")!==undefined?"left":"right";t.css(n,f)})})})};e.fn.supersubs.defaults={minWidth:9,maxWidth:25,extraWidth:0}})(jQuery);(function(e){e.fn.hoverIntent=function(t,n){var r={sensitivity:7,interval:100,timeout:0};r=e.extend(r,n?{over:t,out:n}:t);var i,s,o,u;var a=function(e){i=e.pageX;s=e.pageY};var f=function(t,n){n.hoverIntent_t=clearTimeout(n.hoverIntent_t);if(Math.abs(o-i)+Math.abs(u-s)<r.sensitivity){e(n).unbind("mousemove",a);n.hoverIntent_s=1;return r.over.apply(n,[t])}else{o=i;u=s;n.hoverIntent_t=setTimeout(function(){f(t,n)},r.interval)}};var l=function(e,t){t.hoverIntent_t=clearTimeout(t.hoverIntent_t);t.hoverIntent_s=0;return r.out.apply(t,[e])};var c=function(t){var n=(t.type=="mouseover"?t.fromElement:t.toElement)||t.relatedTarget;while(n&&n!=this){try{n=n.parentNode}catch(t){n=this}}if(n==this){return false}var i=jQuery.extend({},t);var s=this;if(s.hoverIntent_t){s.hoverIntent_t=clearTimeout(s.hoverIntent_t)}if(t.type=="mouseover"){o=i.pageX;u=i.pageY;e(s).bind("mousemove",a);if(s.hoverIntent_s!=1){s.hoverIntent_t=setTimeout(function(){f(i,s)},r.interval)}}else{e(s).unbind("mousemove",a);if(s.hoverIntent_s==1){s.hoverIntent_t=setTimeout(function(){l(i,s)},r.timeout)}}};return this.mouseover(c).mouseout(c)}})(jQuery)