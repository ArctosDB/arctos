var viewport={o:function(){self.innerHeight?(this.pageYOffset=self.pageYOffset,this.pageXOffset=self.pageXOffset,this.innerHeight=self.innerHeight,this.innerWidth=self.innerWidth):document.documentElement&&document.documentElement.clientHeight?(this.pageYOffset=document.documentElement.scrollTop,this.pageXOffset=document.documentElement.scrollLeft,this.innerHeight=document.documentElement.clientHeight,this.innerWidth=document.documentElement.clientWidth):document.body&&(this.pageYOffset=document.body.scrollTop, this.pageXOffset=document.body.scrollLeft,this.innerHeight=document.body.clientHeight,this.innerWidth=document.body.clientWidth);return this},init:function(b){$(b).css("left",Math.round(viewport.o().innerWidth/2)+viewport.o().pageXOffset-Math.round($(b).width()/2));$(b).css("top",Math.round(viewport.o().innerHeight/2)+viewport.o().pageYOffset-Math.round($(b).height()/2))}}; $(document).ready(function(){$(".helpLink").live("click",function(b){var d=this.id;removeHelpDiv();var e=document.createElement("div");e.id="bgDiv";e.className="bgDiv";e.setAttribute("onclick","removeHelpDiv()");document.body.appendChild(e);e=document.createElement("div");e.id="helpDiv";e.className="helpBox";e.innerHTML="<br>Loading...";document.body.appendChild(e);$("#helpDiv").css({position:"absolute",top:b.pageY,left:b.pageX});$(e).load("/doc/get_short_doc.cfm",{fld:d,addCtl:1})});$("#c_identifiers_cust").click(function(b){b= document.createElement("div");b.id="bgDiv";b.className="bgDiv";b.setAttribute("onclick","closeAndRefresh()");document.body.appendChild(b);b=document.createElement("div");b.id="customDiv";b.className="sscustomBox";b.innerHTML="<br>Loading...";document.body.appendChild(b);$(b).load("/includes/SpecSearch/customIDs.cfm",{},function(){viewport.init("#customDiv")})});self!=top&&parent.frames[0].thisStyle&&changeStyle(parent.frames[0].thisStyle)}); function setSessionCustomID(b){$.getJSON("/component/functions.cfc",{method:"setSessionCustomID",val:b,returnformat:"json",queryformat:"column"},function(b){})}function setPrevSearch(){for(var b=get_cookie("schParams").split("|"),d=0;d<b.length;d++){var e=b[d].split("::"),f=e[0],e=e[1];document.getElementById(f)&&(document.getElementById(f).value=e,"tgtForm"!=f||"/bnhmMaps/kml.cfm?action=newReq"!=e&&"SpecimenResultsSummary.cfm"!=e||changeTarget(f,e))}try{setPreviousMap()}catch(g){}} function changeTarget(b,d){0===d.length&&(d="SpecimenResults.cfm");("tgtForm1"==b?document.getElementById("tgtForm"):document.getElementById("tgtForm1")).value=d;document.getElementById("groupByDiv").style.display="none";document.getElementById("groupByDiv1").style.display="none";document.getElementById("kmlDiv").style.display="none";document.getElementById("kmlDiv1").style.display="none";"SpecimenResultsSummary.cfm"==d?(document.getElementById("groupByDiv").style.display="",document.getElementById("groupByDiv1").style.display= ""):"/bnhmMaps/kml.cfm?action=newReq"==d&&(document.getElementById("kmlDiv").style.display="",document.getElementById("kmlDiv1").style.display="");document.SpecData.action=d}function changeGrp(b){var d,e,f;d="groupBy"==b?"groupBy1":"groupBy";b=document.getElementById(b);d=document.getElementById(d);e=b.length;for(f=0;f<e;f++)d.options[f].selected=!1;for(f=0;f<e;f++)b.options[f].selected&&(d.options[f].selected=!0)} function resetSSForm(){document.getElementById("SpecData").reset();try{initialize()}catch(b){}}function r_getSpecSrchPref(b){b=b.split(",");for(var d=0;d<b.length;d++)0<b[d].length&&showHide(b[d],1)}function kmlSync(b,d){theOtherField="1"==b.substr(b.length-1,1)?b.substr(0,b.length-1):b+"1";document.getElementById(theOtherField).value=d} function checkCSV(b){b=b.value;"csv"!=b.substring(b.lastIndexOf(".")+1).toLowerCase()?(alert("Only files with the file extension CSV are allowed"),$("input[type=submit]").hide()):$("input[type=submit]").show()}function getMedia(b,d,e,f,g){$("#imgBrowserCtlDiv").append('<img src="/images/indicator.gif">');$.get("/form/inclMedia.cfm?typ="+b+"&q="+d+"&tgt="+e+"&rpp="+f+"&pg="+g,function(b){$("#"+e).html(b)})} function blockSuggest(b){$.getJSON("/component/functions.cfc",{method:"changeBlockSuggest",onoff:b,returnformat:"json",queryformat:"column"},function(b){"success"==b?$("#browseArctos").html("Suggest Browser disabled. You may turn this feature back on under My Stuff."):alert("An error occured! \n "+b)})}function findPart(b,d,e){d=d.replace("%","_");partpick=window.open("/picks/findPart.cfm?part_name="+d+"&collCde="+e+"&partFld="+b,"","width=400,height=338, resizable,scrollbars")} function isValidEmailAddress(b){return(new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i)).test(b)} function saveThisAnnotation(){var b,d,e,f,g;b=document.getElementById("idtype").value;d=document.getElementById("idvalue").value;e=document.getElementById("annotation").value;f=$("#captchaHash").val();g=$("#captcha").val().toUpperCase();if(20>=e.length)return alert("You must enter an annotation of at least 20 characters to save."),!1;if(!isValidEmailAddress($("#email").val()))return alert("Enter a valid email address."),!1;$.getJSON("/component/functions.cfc",{method:"hashString",string:g,returnformat:"json"}, function(g){if(g!=f)return alert("The CAPTCHA text you entered does not match the image."),!1;$.getJSON("/component/functions.cfc",{method:"addAnnotation",idType:b,idvalue:d,annotation:e,returnformat:"json",queryformat:"column"},function(b){"success"==b?(closeAnnotation(),alert("Your annotations have been saved, and the appropriate curator will be alerted. \n Thank you for helping improve Arctos!")):alert("An error occured! \n "+b);return!0})})} function openAnnotation(b){var d;d=document.createElement("div");d.id="bgDiv";d.className="bgDiv";d.setAttribute("onclick","closeAnnotation()");document.body.appendChild(d);d=document.createElement("div");d.id="annotateDiv";d.className="annotateBox";d.innerHTML="";d.src="";document.body.appendChild(d);b="/info/annotate.cfm?q="+b;$("#annotateDiv").load(b,{},function(){viewport.init("#annotateDiv")})} function npPage(b,d,e){b="/includes/taxonomy/specTaxMedia.cfm"+("?Result_Per_Page="+d+"&offset="+b+"&taxon_name_id="+e);$("#imgBrowserCtlDiv").append('<img src="/images/indicator.gif">');$.get(b,function(b){$("#specTaxMedia").html(b)})}function closeAnnotation(){var b;b=document.getElementById("bgDiv");document.body.removeChild(b);b=document.getElementById("annotateDiv");document.body.removeChild(b)} function saveSearch(b,d){var e,f,g;e=Date.now();"undefined"!==typeof d&&0<d.length&&(g="ERROR: "+d+"\n\n");g=g+("Saving search for URL:\n\n"+b+" \n\nName your saved search (or copy and ")+"paste the link above).\n\nManage or email saved searches from your profile, or go to /saved/{name of saved search}. Note ";g+="that saved searches, except those sepecifying only GUIDs, are dynamic; results change as data changes.\n\nName of saved search (must be unique):\n";e=prompt(g,e);null!==e&&(f=encodeURIComponent(e), e=encodeURI(b),$.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:e,srchName:f,returnformat:"json",queryformat:"column"},function(d){"success"!=d?saveSearch(b,d):alert("Saved search "+f+". Find it in the My Stuff tab.")}))}function crcloo(b,d){$.getJSON("/component/functions.cfc",{method:"clientResultColumnList",ColumnList:b,in_or_out:d,returnformat:"json",queryformat:"column"})} function checkAllById(b){var d;d=b.split(",");$.each(d,function(b,d){$("#"+d).prop("checked",!0)});crcloo(b,"in")}function uncheckAllById(b){var d;d=b.split(",");$.each(d,function(b,d){$("#"+d).prop("checked",!1)});crcloo(b,"out")}function hidePageLoad(){$("#loading").hide()} function addPartToContainer(){var b,d,e,f,g;document.getElementById("pTable").className="red";b=document.getElementById("collection_object_id").value;d=document.getElementById("part_name").value;e=document.getElementById("part_name_2").value;f=document.getElementById("parent_barcode").value;g=document.getElementById("new_container_type").value;if(0===b.length||0===d.length||0===f.length)return alert("Something is null"),!1;$.getJSON("/component/functions.cfc",{method:"addPartToContainer",collection_object_id:b, part_id:d,part_id2:e,parent_barcode:f,new_container_type:g,returnformat:"json",queryformat:"column"},function(b){statAry=b.split("|");b=statAry[0];var d=statAry[1];document.getElementById("pTable").className="";var e=document.getElementById("msgs"),f=document.getElementById("msgs_hist");f.innerHTML=e.innerHTML+"<hr>"+f.innerHTML;e.innerHTML=d;0===b?e.className="error":(e.className="successDiv",document.getElementById("oidnum").focus(),document.getElementById("oidnum").select(),getParts())})} function clonePart(){var b=document.getElementById("collection_id").value,d=document.getElementById("other_id_type").value,e=document.getElementById("oidnum").value;0<b.length&&0<d.length&&0<e.length?$.getJSON("/component/functions.cfc",{method:"getSpecimen",collection_id:b,other_id_type:d,oidnum:e,returnformat:"json",queryformat:"column"},function(b){-1<toString(b.DATA.COLLECTION_OBJECT_ID[0]).indexOf("Error:")?alert(b.DATA.COLLECTION_OBJECT_ID[0]):newPart(b.DATA.COLLECTION_OBJECT_ID[0])}):alert("Error: cannot resolve ID to specimen.")} function checkSubmit(){!0===document.getElementById("submitOnChange").checked&&addPartToContainer()}function newPart(b){var d,e;collection_id=document.getElementById("collection_id").value;d=document.getElementById("part_name").value;e="/form/newPart.cfm?collection_id="+collection_id;e=e+("&collection_object_id="+b)+("&part="+d);divpop(e)} function getParts(){var b,d,e,f,g,h,l,n,m,q,k,p,t,u,v,w,x,y,s,r;b=document.getElementById("collection_id").value;d=document.getElementById("other_id_type").value;e=document.getElementById("oidnum").value;0<b.length&&0<d.length&&0<e.length&&(f=document.createElement("DIV"),f.id="ajaxStatus",f.className="ajaxStatus",f.innerHTML="Fetching parts...",document.body.appendChild(f),g=document.getElementById("noBarcode").checked,h=document.getElementById("noSubsample").checked,$.getJSON("/component/functions.cfc", {method:"getParts",collection_id:b,other_id_type:d,oidnum:e,noBarcode:g,noSubsample:h,returnformat:"json",queryformat:"column"},function(b){l=b.DATA;f=document.getElementById("ajaxStatus");document.body.removeChild(f);n=document.getElementById("thisSpecimen");m=document.getElementById("collection_id");q=document.getElementById("collection_object_id");k=document.getElementById("part_name");p=document.getElementById("part_name_2");t=k.value;u=p.value;k.options.length=0;p.options.length=0;v=m.selectedIndex; w=m.options[v].text;x=document.getElementById("other_id_type").value;y=document.getElementById("oidnum").value;s=w+" "+x+" "+y;if(-1<l.PART_NAME[0].indexOf("Error:"))n.className="error",s+=" = "+l.PART_NAME[0],q.value="",document.getElementById("pTable").className="red";else{document.getElementById("pTable").className="";n.className="";q.value=l.COLLECTION_OBJECT_ID[0];r=document.createElement("option");r.setAttribute("value","");r.appendChild(document.createTextNode(""));p.appendChild(r);for(i=0;i< b.ROWCOUNT;i++)r=document.createElement("option"),option2=document.createElement("option"),r.setAttribute("value",l.PARTID[i]),option2.setAttribute("value",l.PARTID[i]),pStr=l.PART_NAME[i],null!==l.BARCODE[i]&&(pStr+=" ["+l.BARCODE[i]+"]"),r.appendChild(document.createTextNode(pStr)),option2.appendChild(document.createTextNode(pStr)),k.appendChild(r),p.appendChild(option2);k.value=t;p.value=u;s+=" = "+l.COLLECTION[0]+" "+l.CAT_NUM[0]+" ("+l.CUSTOMIDTYPE[0]+" "+l.CUSTOMID[0]+")"}n.innerHTML=s}))} function divpop(b){var d,e;e=document.createElement("div");e.id="bgDiv";e.className="bgDiv";document.body.appendChild(e);e=document.createElement("div");e.id="ppDiv";e.className="pickBox";e.innerHTML="Loading....";e.src="";document.body.appendChild(e);window.XMLHttpRequest?d=new XMLHttpRequest:window.ActiveXObject&&(d=new ActiveXObject("Microsoft.XMLHTTP"));void 0!==d&&(d.onreadystatechange=function(){divpopDone(d)},d.open("GET",b,!0),d.send(""))} function divpopDone(b){if(4==b.readyState){200==b.status?document.getElementById("ppDiv").innerHTML=b.responseText:document.getElementById("ppDiv").innerHTML="ahah error:\n"+b.statusText;b=document.getElementById("ppDiv");var d=document.createElement("span");d.className="popDivControl";d.setAttribute("onclick","divpopClose();");d.innerHTML="X";b.appendChild(d)}} function divpopClose(){var b=document.getElementById("ppDiv");document.body.removeChild(b);b=document.getElementById("bgDiv");document.body.removeChild(b)} function makePart(){var b,d,e,f,g,h,l,n,m,q,k,p,t;b=document.getElementById("collection_object_id").value;d=document.getElementById("npart_name").value;e=document.getElementById("lot_count").value;f=document.getElementById("coll_obj_disposition").value;g=document.getElementById("condition").value;h=document.getElementById("coll_object_remarks").value;l=document.getElementById("barcode").value;n=document.getElementById("new_container_type").value;$.getJSON("/component/functions.cfc",{method:"makePart", collection_object_id:b,part_name:d,lot_count:e,coll_obj_disposition:f,condition:g,coll_object_remarks:h,barcode:l,new_container_type:n,returnformat:"json",queryformat:"column"},function(b){m=b.DATA;q=m.STATUS[0];"error"==q?(k=m.MSG[0],alert(k)):(k="Created part: ",k+=m.PART_NAME[0]+" ",null!==m.BARCODE[0]&&(k+="barcode "+m.BARCODE[0],null!==m.NEW_CONTAINER_TYPE[0]&&(k+="( "+m.NEW_CONTAINER_TYPE[0]+")")),p=document.getElementById("ppDiv"),document.body.removeChild(p),t=document.getElementById("bgDiv"), document.body.removeChild(t),getParts())})}function getAgentInfo(b){removeHelpDiv();var d=document.createElement("div");d.id="bgDiv";d.className="bgDiv";d.setAttribute("onclick","removeHelpDiv()");document.body.appendChild(d);d=document.createElement("div");d.id="helpDiv";d.className="helpBox centered";d.innerHTML='<img src="/images/indicator.gif" style="margin:5em;">';document.body.appendChild(d);$(d).load("/ajax/agentInfo.cfm",{agent_id:b,addCtl:1})} function scrollToAnchor(b){b=$("a[name='"+b+"']");$("html,body").animate({scrollTop:b.offset().top},"slow")}function changefancyCOID(b){$.getJSON("/component/functions.cfc",{method:"changefancyCOID",tgt:b,returnformat:"json",queryformat:"column"},function(b){"success"==b?document.getElementById("fancyCOID").className="":alert("An error occured: "+b)})} function changeBigSearch(b){$.getJSON("/component/functions.cfc",{method:"changeBigSearch",tgt:b,returnformat:"json",queryformat:"column"},function(b){"success"==b?document.getElementById("changeBigSearch").className="":alert("An error occured: "+b)})} function changecustomOtherIdentifier(b){$.getJSON("/component/functions.cfc",{method:"changecustomOtherIdentifier",tgt:b,returnformat:"json",queryformat:"column"},function(b){"success"==b?document.getElementById("customOtherIdentifier").className="":alert("An error occured: "+b)})}function removeHelpDiv(){$("#bgDiv").remove();$("#helpDiv").remove()} function saveSpecSrchPref(b,d){var e,f,g,h,l;$.getJSON("/component/functions.cfc",{method:"saveSpecSrchPref",id:b,onOff:d,returnformat:"json",queryformat:"column"},function(n){e=n.split(",");f=e[0];b=e[1];d=e[2];if("cookie"==f){g=[];h=readCookie("specsrchprefs");l=-1;if(null!==h)for(g=h.split(","),i=0;i<g.length;i++)g[i]==b&&(l=i);1==d?-1==l&&g.push(b):-1!=l&&g.splice(l,1);n=g.join();createCookie("specsrchprefs",n,0)}})} function showHide(b,d){var e,f;$("#c_"+b).length&&$("#e_"+b).length&&("spatial_query"==b?(f='<span class="secControl" style="font-size:.9em;" id="c_'+b+'" onclick="showHide(\''+b+"',0)\">Hide Google Map</span>",e='<span class="secControl" style="font-size:.9em;" id="c_'+b+'" onclick="showHide(\''+b+"',1)\">Select on Google Map</span>"):(f='<span class="secControl" id="c_'+b+'" onclick="showHide(\''+b+"',0)\">Show Fewer Options</span>",e='<span class="secControl" id="c_'+b+'" onclick="showHide(\''+ b+"',1)\">Show More Options</span>"),1==d?(e="/includes/SpecSearch/"+b+".cfm",$("#c_"+b).html('<img src="/images/indicator.gif">'),$.get(e,function(e){$("#e_"+b).html(e);$("#c_"+b).replaceWith(f);saveSpecSrchPref(b,d)})):($("#e_"+b).html(""),$("#c_"+b).replaceWith(e),saveSpecSrchPref(b,d)))}function closeAndRefresh(){var b;document.location=location.href;b=document.getElementById("customDiv");document.body.removeChild(b)} function getFormValues(){var b,d,e,f,g,h;b=document.getElementById("SpecData");d=b.length;e=[];for(f=0;f<d;f++)g=b.elements[f],h=g.name,g=g.value,0<h.length&&0<g.length&&"selectedCoords"!=h&&(h=h+"::"+String(g),-1==e.indexOf(h)&&e.push(h));b=e.join("|");document.cookie="schParams="+b}function createCookie(b,d,e){var f;e?(f=new Date,f.setTime(f.getTime()+864E5*e),e="; expires="+f.toGMTString()):e="";document.cookie=b+"="+d+e+"; path=/"} function readCookie(b){var d,e,f;b+="=";d=document.cookie.split(";");for(e=0;e<d.length;e++){for(f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return f.substring(b.length,f.length)}return null}function get_cookie(b){return(b=document.cookie.match("(^|;) ?"+b+"=([^;]*)(;|$)"))?unescape(b[2]):null} function changeexclusive_collection_id(b){$.getJSON("/component/functions.cfc",{method:"changeexclusive_collection_id",tgt:b,returnformat:"json",queryformat:"column"},function(b){"success"==b?document.getElementById("exclusive_collection_id").className="":alert("An error occured: "+b)})}function IsNumeric(b){var d=!0,e;for(i=0;i<b.length&&!0===d;i++)e=b.charAt(i),-1=="0123456789.".indexOf(e)&&(d=!1);return d} function orapwCheck(b,d){var e=/^[A-Za-z0-9!$%&_?(\-)<>=/:;*\.]$/,f="Password is acceptable";-1<b.indexOf(d)&&(f="Password may not contain your username.");if(6>b.length||30<b.length)f="Password must be between 6 and 30 characters.";b.match(/[a-zA-Z]/)||(f="Password must contain at least one letter.");b.match(/\d+/)||(f="Password must contain at least one number.");b.match(/[!,$,%,&,*,?,_,-,(,),<,>,=,/,:,;,.]/)||(f="Password must contain at least one of: !,$,%,&,*,?,_,-,(,),<,>,=,/,:,;.");for(var g= 0;g<b.length;g++)b.charAt(g).match(e)||(f="Password may contain only A-Z, a-z, 0-9, and !$%&()`*+,-/:;<=>?_.");return f}function getCtDoc(b,d){windowOpener("/info/ctDocumentation.cfm?table="+b+"&field="+d,"ctDocWin","width=700,height=400, resizable,scrollbars")}function windowOpener(b,d,e){popupWins=[];"object"!=typeof popupWins[d]?popupWins[d]=window.open(b,d,e):popupWins[d].closed?popupWins[d]=window.open(b,d,e):popupWins[d].location.href=b;popupWins[d].focus()} function getDocs(b,d){$.getJSON("/component/functions.cfc",{method:"get_docs",uri:b,anchor:d,returnformat:"json"},function(b){"404"==b?alert("help not found."):siteHelpWin=windowOpener(b,"HelpWin","width=800,height=600, resizable,scrollbars,location,toolbar")})}function noenter(b){return 13==(window.event?window.event.keyCode:b.which)?!1:!0}function chgCondition(b){helpWin=windowOpener("/picks/condition.cfm?collection_object_id="+b,"conditionWin","width=800,height=338, resizable,scrollbars")} function getLoan(b,d,e,f){loanpickwin=window.open("/picks/getLoan.cfm?LoanIDFld="+b+"&LoanNumberFld="+d+"&loanNumber="+e+"&agent_name="+f,"","width=400,height=338, resizable,scrollbars")}function getAgent(b,d,e,f,g){agentpickwin=window.open("/picks/findAgent.cfm?agentIdFld="+b+"&agentNameFld="+d+"&formName="+e+"&agent_name="+f+"&allowCreation="+g,"","width=400,height=338, resizable,scrollbars")} function getProject(b,d,e,f){projpickwin=window.open("/picks/findProject.cfm?projIdFld="+b+"&projNameFld="+d+"&formName="+e+"&project_name="+f,"","width=400,height=338, resizable,scrollbars")}function findCatalogedItem(b,d,e,f,g,h){catItemWin=window.open("/picks/findCatalogedItem.cfm?collIdFld="+b+"&CatNumStrFld="+d+"&formName="+e+"&oidType="+f+"&oidNum="+g+"&collID="+h,"","width=400,height=338, resizable,scrollbars")} function findCollEvent(b,d,e,f){ColPickwin=window.open("/picks/findCollEvent.cfm?collIdFld="+b+"&dispField="+e+"&formName="+d+"&collecting_event_name="+f,"","width=800,height=600, resizable,scrollbars")}function getPublication(b,d,e,f){window.open("/picks/findPublication.cfm?pubStringFld="+b+"&pubIdFld="+d+"&publication_title="+e+"&formName="+f,"","width=400,height=338, resizable,scrollbars")} function getAccn(b,d,e){window.open("/picks/findAccn.cfm?r_accnNumber="+b+"&rtnFldID="+d+"&r_InstAcrColnCde="+e,"","width=400,height=338, resizable,scrollbars")}function getAccnMedia(b,d){window.open("/picks/getAccnMedia.cfm?idOfTxtFld="+b+"&idOfPKeyFld="+d,"","width=400,height=338, resizable,scrollbars")}function getAccn2(b,d){window.open("/picks/getAccn.cfm?accnNumber="+b+"&collectionID="+d,"","width=400,height=338, resizable,scrollbars")} function getGeog(b,d,e,f){geogpickwin=window.open("/picks/findHigherGeog.cfm?geogIdFld="+b+"&geogStringFld="+d+"&formName="+e+"&geogString="+f,"","width=400,height=338, resizable,scrollbars")}function confirmDelete(b,d){if(!0===confirm("Are you sure you want to delete "+(d||"this record")+"?"))document[b].submit();else return!1}function getHistory(b){historyWin=windowOpener("/info/ContHistory.cfm?container_id="+b,"historyWin","width=800,height=600, resizable,scrollbars")} function getQuadHelp(){helpWin=windowOpener("/info/quad.cfm","quadHelpWin","width=800,height=600, resizable,scrollbars,status")}function getLegal(b){helpWin=windowOpener("/info/legal.cfm?content="+b,"legalWin","width=400,height=338, resizable,scrollbars")}function getInfo(b,d){infoWin=windowOpener("/info/SpecInfo.cfm?subject="+b+"&thisId="+d,"infoWin","width=800,height=500, resizable,scrollbars")} function addLoanItem(b){loanItemWin=windowOpener("/user/loanItem.cfm?collection_object_id="+b,"loanItemWin","width=800,height=500, resizable,scrollbars,toolbar,menubar")}function findMedia(b,d,e){mediapick=window.open("/picks/findMedia.cfm?mediaIdFld="+d+"&mediaStringFld="+b+"&media_uri="+e,"","width=400,height=338, resizable,scrollbars")} function taxaPick(b,d,e,f){taxapick=window.open("/picks/TaxaPick.cfm?taxonIdFld="+b+"&taxonNameFld="+d+"&formName="+e+"&scientific_name="+f,"","width=400,height=338, resizable,scrollbars")}function taxaPickIdentification(b,d,e,f){taxapick=window.open("/picks/TaxaPickIdentification.cfm?taxonIdFld="+b+"&taxonNameFld="+d+"&formName="+e+"&scientific_name="+f,"","width=400,height=338, resizable,scrollbars")} function CatItemPick(b,d,e,f){window.open("/picks/CatalogedItemPick.cfm?collIdFld="+b+"&catNumFld="+d+"&formName="+e+"&sciNameFld="+f,"","width=400,height=338, resizable,scrollbars")}function findAgentName(b,d,e){agentpick=window.open("/picks/findAgentName.cfm?agentIdFld="+b+"&agentNameFld="+d+"&agentName="+e,"","width=400,height=338, resizable,scrollbars")} function addrPick(b,d,e){addrpick=window.open("/picks/AddrPick.cfm?addrIdFld="+b+"&addrFld="+d+"&formName="+e,"","width=400,height=338, resizable,scrollbars")}function GeogPick(b,d,e){geogpick=window.open("/picks/GeogPick2.cfm?geogIdFld="+b+"&highGeogFld="+d+"&formName="+e,"","width=600,height=600, toolbar,resizable,scrollbars,")} function LocalityPick(b,d,e,f){localitypick=window.open("/picks/LocalityPick.cfm?localityIdFld="+b+"&speclocFld="+d+"&formName="+e+"&locality_name="+f,"","width=800,height=600,resizable,scrollbars,")}function findJournal(b,d,e,f){window.open("/picks/findJournal.cfm?journalIdFld="+b+"&journalNameFld="+d+"&formName="+e+"&journalName="+f,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")} function deleteEncumbrance(b,d){window.open("/picks/DeleteEncumbrance.cfm?encumbrance_id="+b+"&collection_object_id="+d,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")} function getAllSheets(){var b,d,e,f;if(!window.ScriptEngine&&navigator.__ice_version)return document.styleSheets;if(document.getElementsByTagName)b=document.getElementsByTagName("LINK"),d=document.getElementsByTagName("STYLE");else if(document.styleSheets&&document.all)b=document.all.tags("LINK"),d=document.all.tags("STYLE");else return[];f=0;for(os=[];b[f];f++)e=b[f].rel?b[f].rel:b[f].getAttribute?b[f].getAttribute("rel"):"","string"==typeof e&&e.toLowerCase().indexOf("style")+1&&(os[os.length]= b[f]);for(f=0;d[f];f++)os[os.length]=d[f];return os}function changeStyle(){var b,d;b=0;for(ss=getAllSheets();ss[b];b++)for(ss[b].title&&(ss[b].disabled=!0),d=0;d<arguments.length;d++)ss[b].title==arguments[d]&&(ss[b].disabled=!1);ss.length||alert("Your browser cannot change stylesheets")} function toProperCase(b){b=document.getElementById(b);var d=b.selectionStart,e=b.selectionEnd,f=b.value.substring(d,e).toLowerCase().replace(/^(.)|\s(.)/g,function(b){return b.toUpperCase()}),d=b.value.substring(0,d),e=b.value.substring(e,b.value.length);b.value=d+f+e}function italicize(b){b=document.getElementById(b);var d=b.value.length,e=b.selectionStart,f=b.selectionEnd,g=b.value.substring(e,f);0<g.length&&(g="<i>"+g+"</i>",b.value=b.value.substring(0,e)+g+b.value.substring(f,d))} function bold(b){b=document.getElementById(b);var d=b.value.length,e=b.selectionStart,f=b.selectionEnd,g=b.value.substring(e,f);0<g.length&&(g="<b>"+g+"</b>",b.value=b.value.substring(0,e)+g+b.value.substring(f,d))}function superscript(b){b=document.getElementById(b);var d=b.value.length,e=b.selectionStart,f=b.selectionEnd,g=b.value.substring(e,f);0<g.length&&(g="<sup>"+g+"</sup>",b.value=b.value.substring(0,e)+g+b.value.substring(f,d))} function subscript(b){b=document.getElementById(b);var d=b.value.length,e=b.selectionStart,f=b.selectionEnd,g=b.value.substring(e,f);0<g.length&&(g="<sub>"+g+"</sub>",b.value=b.value.substring(0,e)+g+b.value.substring(f,d))} function setPartAttOptions(b,d){var e,f,g,h,l;$.getJSON("/component/functions.cfc",{method:"getPartAttOptions",returnformat:"json",patype:d},function(d){e="attribute_value_"+b;g="attribute_units_"+b;if("unit"==d.TYPE){f='<input type="text" name="'+e+'" id="'+e+'">';$("#v_"+b).html(f);h=d.VALUES.split("|");f='<select name="'+g+'" id="'+g+'">';for(a=0;a<h.length;++a)f+='<option value="'+h[a]+'">'+h[a]+"</option>";f+="</select>";$("#u_"+b).html(f)}else{if("value"==d.TYPE){h=d.VALUES.split("|");f='<select name="'+ e+'" id="'+e+'">';for(a=0;a<h.length;++a)f+='<option value="'+h[a]+'">'+h[a]+"</option>";f+="</select>";$("#v_"+b).html(f)}else l='<input type="text" name="'+e+'" id="'+e+'">',$("#v_"+b).html(l);$("#u_"+b).html("")}})}function mgPartAtts(b){addBGDiv("closePartAtts()");var d=document.createElement("iFrame");d.id="partsAttDiv";d.className="annotateBox";d.innerHTML="<br>Loading...";document.body.appendChild(d);d.src="/form/partAtts.cfm?partID="+b;viewport.init("#partsAttDiv")} function closePartAtts(){$("#bgDiv").remove();$("#partsAttDiv").remove();$("#bgDiv",window.parent.document).remove();$("#partsAttDiv",window.parent.document).remove()}function cloneTransAgent(b){var d=$("#agent_id_"+b).val(),e=$("#trans_agent_"+b).val(),f=$("#cloneTransAgent_"+b).val();$("#cloneTransAgent_"+b).val("");addTransAgent(d,e,f)} function addTransAgent(b,d,e){"undefined"==typeof b&&(b="");"undefined"==typeof d&&(d="");"undefined"==typeof e&&(e="");$.getJSON("/component/functions.cfc",{method:"getTrans_agent_role",returnformat:"json",queryformat:"column"},function(f){var g=parseInt(document.getElementById("numAgents").value)+1,h;h="<tr><td>"+('<input type="hidden" name="trans_agent_id_'+g+'" id="trans_agent_id_'+g+'" value="new">')+('<input type="text" id="trans_agent_'+g+'" name="trans_agent_'+g+'" class="reqdClr" size="30" value="'+ d+'"');h+=" onchange=\"getAgent('agent_id_"+g+"','trans_agent_"+g+"','editloan',this.value);\"";h+=' return false;"\tonKeyPress="return noenter(event);">';h+='<input type="hidden" id="agent_id_'+g+'" name="agent_id_'+g+'" value="'+b+'">';h+="</td><td>";h+='<select name="trans_agent_role_'+g+'" id="trans_agent_role_'+g+'">';for(a=0;a<f.ROWCOUNT;++a)h+="<option ",e==f.DATA.TRANS_AGENT_ROLE[a]&&(h+=' selected="selected"'),h+=' value="'+f.DATA.TRANS_AGENT_ROLE[a]+'">'+f.DATA.TRANS_AGENT_ROLE[a]+"</option>"; h+="</td><td>";h+='<input type="checkbox" name="del_agnt_'+g+'" name="del_agnt_'+g+'" value="1">';h+="</td><td>";h+='<select id="cloneTransAgent_'+g+'" onchange="cloneTransAgent('+g+')" style="width:8em">';h+='<option value=""></option>';for(a=0;a<f.ROWCOUNT;++a)h+='<option value="'+f.DATA.TRANS_AGENT_ROLE[a]+'">'+f.DATA.TRANS_AGENT_ROLE[a]+"</option>";h+="</select>";h+="</td><td>-</td></tr>";document.getElementById("numAgents").value=g;$("#loanAgents tr:last").after(h)})} $("#uploadMedia").live("click",function(b){addBGDiv("removeUpload()");b=document.createElement("iFrame");b.id="uploadDiv";b.className="uploadMediaDiv";b.innerHTML="<br>Loading...";document.body.appendChild(b);b.src="/info/upMedia.cfm";viewport.init("#uploadDiv")});function removeUpload(){document.getElementById("uploadDiv")&&$("#uploadDiv").remove();removeBgDiv()} function closeUpload(b,d){document.getElementById("media_uri").value=b;document.getElementById("preview_uri").value=d;var e=b.split(".").pop();"jpg"==e||"jpeg"==e?($("#mime_type").val("image/jpeg"),$("#media_type").val("image")):"pdf"==e?($("#mime_type").val("application/pdf"),$("#media_type").val("text")):"mp3"==e?($("#mime_type").val("audio/mpeg3"),$("#media_type").val("audio")):"wav"==e?($("#mime_type").val("audio/x-wav"),$("#media_type").val("audio")):"dng"==e?($("#mime_type").val("image/dng"), $("#media_type").val("image")):"png"==e?($("#mime_type").val("image/png"),$("#media_type").val("image")):"tif"==e||"tiff"==e?($("#mime_type").val("image/tiff"),$("#media_type").val("image")):"htm"==e||"html"==e?($("#mime_type").val("text/html"),$("#media_type").val("")):"txt"==e?($("#mime_type").val("text/plain"),$("#media_type").val("text")):"mp4"==e&&($("#mime_type").val("video/mp4"),$("#media_type").val("video"));removeUpload()} function generateMD5(){var b;$.getJSON("/component/functions.cfc",{method:"genMD5",uri:$("#media_uri").val(),returnformat:"json",queryformat:"column"},function(d){b=parseInt($("#number_of_labels").val())+1;addLabel(b);$("#label__"+b).val("MD5 checksum");$("#label_value__"+b).val(d)})}function closePreviewUpload(b){var d=document.getElementById("uploadDiv");document.body.removeChild(d);document.getElementById("preview_uri").value=b} function clickUploadPreview(){var b=document.createElement("iFrame");b.id="uploadDiv";b.name="uploadDiv";b.className="uploadMediaDiv";document.body.appendChild(b);b.src="/info/upMediaPreview.cfm"} function pickedRelationship(b){var d=document.getElementById(b).value,e=b.lastIndexOf("__");b=b.substring(e+2,b.length);d=d.split(" ");d=d[d.length-1];e="related_id__"+b;b="related_value__"+b;document.getElementById(e).value="";document.getElementById(b).value="";""!==d&&("agent"==d?getAgent(e,b,"newMedia",""):"locality"==d?LocalityPick(e,b,"newMedia"):"collecting_event"==d?findCollEvent(e,"newMedia",b):"cataloged_item"==d?findCatalogedItem(e,b,"newMedia"):"project"==d?getProject(e,b,"newMedia"): "taxonomy"==d?taxaPick(e,b,"newMedia"):"publication"==d?getPublication(b,e,"","newMedia"):"accn"==d?getAccnMedia(b,e):"media"==d?findMedia(b,e):"loan"==d?getLoan(e,b):"delete"==d?document.getElementById(b).value="Marked for deletion.....":alert("Something is broken. I have no idea what to do with a relationship to "+d))} function addRelation(b){var d,e,f,g;d=document.getElementById("relationships");e=document.createElement("div");e.id="relationshipDiv__"+b;d.appendChild(e);f=document.getElementById("relationship__"+(b-1)).cloneNode(!0);f.name="relationship__"+b;f.id="relationship__"+b;f.value="delete";e.appendChild(f);c=document.createElement("textNode");c.innerHTML=":&nbsp;";e.appendChild(c);f=b-1;g=document.getElementById("related_value__"+f).cloneNode(!0);g.name="related_value__"+b;g.id="related_value__"+b;g.value= "";e.appendChild(g);f=document.getElementById("related_id__"+f).cloneNode(!0);f.name="related_id__"+b;f.id="related_id__"+b;e.appendChild(f);e=document.getElementById("addRelationship");d.removeChild(e);e.setAttribute("onclick","addRelation("+(b+1)+")");d.appendChild(e);b=document.getElementById("number_of_relations");b.value=parseInt(b.value)+1} function addLabel(b){var d,e,f,g;d=document.getElementById("labels");e=document.createElement("div");e.id="labelsDiv__"+b;d.appendChild(e);f=b-1;g=document.getElementById("label__"+f).cloneNode(!0);g.name="label__"+b;g.id="label__"+b;g.value="";e.appendChild(g);c=document.createElement("textNode");c.innerHTML=":&nbsp;";e.appendChild(c);f=document.getElementById("label_value__"+f).cloneNode(!0);f.name="label_value__"+b;f.id="label_value__"+b;f.value="";e.appendChild(f);e=document.getElementById("addLabel"); d.removeChild(e);e.setAttribute("onclick","addLabel("+(b+1)+")");d.appendChild(e);b=document.getElementById("number_of_labels");b.value=parseInt(b.value)+1} function tog_AgentRankDetail(b){1==b?(document.getElementById("agentRankDetails").style.display="block",$("#t_agentRankDetails").text("Hide Details").removeAttr("onclick").bind("click",function(){tog_AgentRankDetail(0)})):(document.getElementById("agentRankDetails").style.display="none",$("#t_agentRankDetails").text("Show Details").removeAttr("onclick").bind("click",function(){tog_AgentRankDetail(1)}))} function saveAgentRank(){$.getJSON("/component/functions.cfc",{method:"saveAgentRank",agent_id:$("#agent_id").val(),agent_rank:$("#agent_rank").val(),remark:$("#remark").val(),transaction_type:$("#transaction_type").val(),returnformat:"json",queryformat:"column"},function(b){0<b.length&&"fail"==b.substring(0,4)?alert(b):(b="Thank you for adding an agent rank."+('<p><span class="likeLink" onclick="removePick();rankAgent('+b+')">Refresh</span></p>')+'<p><span class="likeLink" onclick="removePick();">Done</span></p>', document.getElementById("pickDiv").innerHTML=b)})}function revokeAgentRank(b){$.getJSON("/component/functions.cfc",{method:"revokeAgentRank",agent_rank_id:b,returnformat:"json",queryformat:"column"},function(d){0<d.length&&"fail"==d.substring(0,4)?alert(d):$("#tablr"+b).remove()})}function removeMediaMultiCatItem(){$("#bgDiv").remove();$("#pickFrame").remove()} function manyCatItemToMedia(b){var d=document.createElement("div");d.id="bgDiv";d.className="bgDiv";d.setAttribute("onclick","removeMediaMultiCatItem()");document.body.appendChild(d);$('<iframe id="pickFrame" name="pickFrame" class="pickDiv" src="/includes/forms/manyCatItemToMedia.cfm?media_id='+b+'">').appendTo("body");viewport.init("#pickDiv")} function rankAgent(b){addBGDiv("removePick()");var d=document.createElement("div");d.id="pickDiv";d.className="pickDiv";d.innerHTML="<br>Loading...";document.body.appendChild(d);$.get("/includes/forms/agentrank.cfm",{agent_id:b},function(b){document.getElementById("pickDiv").innerHTML=b;viewport.init("#pickDiv")})}function pickThis(b,d,e,f){document.getElementById(b).value=e;document.getElementById(d).value=f;document.getElementById(b).className="goodPick";removePick()} function removePick(){document.getElementById("pickDiv")&&$("#pickDiv").remove();removeBgDiv()}function addBGDiv(b){var d=document.createElement("div");d.id="bgDiv";d.className="bgDiv";if(null===b||0===b.length)b="removeBgDiv()";d.setAttribute("onclick",b);document.body.appendChild(d)}function removeBgDiv(){document.getElementById("bgDiv")&&$("#bgDiv").remove()} function deleteAgent(b){$("#author_name"+b).addClass("red").val("deleted");$("#authortr"+b+" td:nth-child(1)").addClass("red");$("#authortr"+b+" td:nth-child(3)").addClass("red")} (function(b){b.fn.superfish=function(d){var f=b.fn.superfish,g=f.c,h=b(['<span class="',g.arrowClass,'"> &#187;</span>'].join("")),l=function(){var d=b(this),e=m(d);clearTimeout(e.sfTimer);d.showSuperfishUl().siblings().hideSuperfishUl()},n=function(){var d=b(this),e=m(d),g=f.op;clearTimeout(e.sfTimer);e.sfTimer=setTimeout(function(){g.retainPath=-1<b.inArray(d[0],g.$path);d.hideSuperfishUl();g.$path.length&&1>d.parents(["li.",g.hoverClass].join("")).length&&l.call(g.$path)},g.delay)},m=function(b){b= b.parents(["ul.",g.menuClass,":first"].join(""))[0];f.op=f.o[b.serial];return b};return this.each(function(){var m=this.serial=f.o.length,k=b.extend({},f.defaults,d);k.$path=b("li."+k.pathClass,this).slice(0,k.pathLevels).each(function(){b(this).addClass([k.hoverClass,g.bcClass].join(" ")).filter("li:has(ul)").removeClass(k.pathClass)});f.o[m]=f.op=k;b("li:has(ul)",this)[b.fn.hoverIntent&&!k.disableHI?"hoverIntent":"hover"](l,n).each(function(){k.autoArrows&&b(">a:first-child",this).addClass(g.anchorClass).append(h.clone())}).not("."+ g.bcClass).hideSuperfishUl();var p=b("a",this);p.each(function(b){var d=p.eq(b).parents("li");p.eq(b).focus(function(){l.call(d)}).blur(function(){n.call(d)})});k.onInit.call(this)}).each(function(){var d=[g.menuClass];!f.op.dropShadows||b.browser.msie&&7>b.browser.version||d.push(g.shadowClass);b(this).addClass(d.join(" "))})};var d=b.fn.superfish;d.o=[];d.op={};d.IE7fix=function(){var e=d.op;b.browser.msie&&6<b.browser.version&&e.dropShadows&&void 0!==e.animation.opacity&&this.toggleClass(d.c.shadowClass+ "-off")};d.c={bcClass:"sf-breadcrumb",menuClass:"sf-js-enabled",anchorClass:"sf-with-ul",arrowClass:"sf-sub-indicator",shadowClass:"sf-shadow"};d.defaults={hoverClass:"sfHover",pathClass:"overideThisToUse",pathLevels:1,delay:800,animation:{opacity:"show"},speed:"normal",autoArrows:!0,dropShadows:!0,disableHI:!1,onInit:function(){},onBeforeShow:function(){},onShow:function(){},onHide:function(){}};b.fn.extend({hideSuperfishUl:function(){var e=d.op,f=!0===e.retainPath?e.$path:"";e.retainPath=!1;f=b(["li.", e.hoverClass].join(""),this).add(this).not(f).removeClass(e.hoverClass).find(">ul").hide().css("visibility","hidden");e.onHide.call(f);return this},showSuperfishUl:function(){var b=d.op,f=this.addClass(b.hoverClass).find(">ul:hidden").css("visibility","visible");d.IE7fix.call(f);b.onBeforeShow.call(f);f.animate(b.animation,b.speed,function(){d.IE7fix.call(f);b.onShow.call(f)});return this}})})($); (function(b){b.fn.supersubs=function(d){var e=b.extend({},b.fn.supersubs.defaults,d);return this.each(function(){var d=b(this),g=b.meta?b.extend({},e,d.data()):e,h=b('<li id="menu-fontsize">&#8212;</li>').css({padding:0,position:"absolute",top:"-999em",width:"auto"}).appendTo(d).width();b("#menu-fontsize").remove();$ULs=d.find("ul");$ULs.each(function(d){d=$ULs.eq(d);var e=d.children(),f=e.children("a"),q=e.css("white-space","nowrap").css("float"),k=d.add(e).add(f).css({"float":"none",width:"auto"}).end().end()[0].clientWidth/ h,k=k+g.extraWidth;k>g.maxWidth?k=g.maxWidth:k<g.minWidth&&(k=g.minWidth);k+="em";d.css("width",k);e.css({"float":q,width:"100%","white-space":"normal"}).each(function(){var d=b(">ul",this),e=void 0!==d.css("left")?"left":"right";d.css(e,k)})})})};b.fn.supersubs.defaults={minWidth:9,maxWidth:25,extraWidth:0}})($); (function(b){b.fn.hoverIntent=function(d,e){var f={sensitivity:7,interval:100,timeout:0},f=b.extend(f,e?{over:d,out:e}:d),g,h,l,n,m=function(b){g=b.pageX;h=b.pageY},q=function(d,e){e.hoverIntent_t=clearTimeout(e.hoverIntent_t);if(Math.abs(l-g)+Math.abs(n-h)<f.sensitivity)return b(e).unbind("mousemove",m),e.hoverIntent_s=1,f.over.apply(e,[d]);l=g;n=h;e.hoverIntent_t=setTimeout(function(){q(d,e)},f.interval)},k=function(d){for(var e=("mouseover"==d.type?d.fromElement:d.toElement)||d.relatedTarget;e&& e!=this;)try{e=e.parentNode}catch(g){e=this}if(e==this)return!1;var h=b.extend({},d),k=this;k.hoverIntent_t&&(k.hoverIntent_t=clearTimeout(k.hoverIntent_t));"mouseover"==d.type?(l=h.pageX,n=h.pageY,b(k).bind("mousemove",m),1!=k.hoverIntent_s&&(k.hoverIntent_t=setTimeout(function(){q(h,k)},f.interval))):(b(k).unbind("mousemove",m),1==k.hoverIntent_s&&(k.hoverIntent_t=setTimeout(function(){k.hoverIntent_t=clearTimeout(k.hoverIntent_t);k.hoverIntent_s=0;f.out.apply(k,[h])},f.timeout)))};return this.mouseover(k).mouseout(k)}})($);