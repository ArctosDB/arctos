/*
 * jqGrid common function
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/ 
 */
var showModal=function(a){a.w.show()};var closeModal=function(a){a.w.hide();if(a.o){a.o.remove()}};function createModal(a,d,b,e,h,c){var g=b.imgpath?b.imgpath+b.closeicon:b.closeicon;var f=document.createElement('div');jQuery(f).addClass("modalwin").attr("id",a.themodal);var k=jQuery('<div id="'+a.modalhead+'"><table width="100%"><tbody><tr><td class="modaltext">'+b.caption+'</td> <td style="text-align:right" ><a href="javascript:void(0);" class="jqmClose">'+(g!=''?'<img src="'+g+'" border="0"/>':'X')+'</a></td></tr></tbody></table> </div>').addClass("modalhead");var j=document.createElement('div');jQuery(j).addClass("modalcontent").attr("id",a.modalcontent);jQuery(j).append(d);f.appendChild(j);var m=document.createElement("div");jQuery(m).addClass("loading").html(b.processData||"");jQuery(f).prepend(m);jQuery(f).prepend(k);jQuery(f).addClass("jqmWindow");if(b.drag){jQuery(f).append("<img  class='jqResize' src='"+b.imgpath+"resize.gif'/>")}if(c===true){jQuery('body').append(f)}else{jQuery(f).insertBefore(e)}if(b.left==0&&b.top==0){var i=[];i=findPos(h);b.left=i[0]+4;b.top=i[1]+4}if(b.width==0||!b.width){b.width=300}if(b.height==0||!b.width){b.height=200}if(!b.zIndex){b.zIndex=950}jQuery(f).css({top:b.top+"px",left:b.left+"px",width:b.width+"px",height:b.height+"px",zIndex:b.zIndex});return false};function viewModal(a,d){d=jQuery.extend({toTop:true,overlay:10,modal:false,onShow:showModal,onHide:closeModal},d||{});jQuery(a).jqm(d).jqmShow();return false};function hideModal(a){jQuery(a).jqmHide()}function DnRModal(a,d){jQuery(d).css('cursor','move');jQuery(a).jqDrag(d).jqResize(".jqResize");return false};function info_dialog(d,b,e,h){var c="<div id='info_id'>";c+="<div align='center'><br />"+b+"<br /><br />";c+="<input type='button' size='10' id='closedialog' class='jqmClose EditButton' value='"+e+"' />";c+="</div></div>";createModal({themodal:'info_dialog',modalhead:'info_head',modalcontent:'info_content'},c,{width:290,height:120,drag:false,caption:"<b>"+d+"</b>",imgpath:h,closeicon:'ico-close.gif',left:250,top:170},'','',true);viewModal("#info_dialog",{onShow:function(a){a.w.show()},onHide:function(a){a.w.hide().remove();if(a.o){a.o.remove()}},modal:true})};function findPos(a){var d=curtop=0;if(a.offsetParent){do{d+=a.offsetLeft;curtop+=a.offsetTop}while(a=a.offsetParent)}return[d,curtop]};function isArray(a){if(a.constructor.toString().indexOf("Array")==-1){return false}else{return true}};function createEl(d,b,e,h){var c="";switch(d){case"textarea":c=document.createElement("textarea");if(!b.cols&&h){jQuery(c).css("width","99%")}jQuery(c).attr(b);if(e=="&nbsp;"||e=="&#160;"){e=''}jQuery(c).val(e);break;case"checkbox":c=document.createElement("input");c.type="checkbox";jQuery(c).attr({id:b.id,name:b.name});if(!b.value){e=e.toLowerCase();if(e.search(/(false|0|no|off|undefined)/i)<0&&e!==""){c.checked=true;c.defaultChecked=true;c.value=e}else{c.value="on"}jQuery(c).attr("offval","off")}else{var g=b.value.split(":");if(e==g[0]){c.checked=true;c.defaultChecked=true}c.value=g[0];jQuery(c).attr("offval",g[1])}break;case"select":c=document.createElement("select");var f=b.multiple==true?true:false;if(b.value){var k=[];if(f){jQuery(c).attr({multiple:"multiple"});k=e.split(",");k=jQuery.map(k,function(a){return jQuery.trim(a)})}if(typeof b.size==='undefined'){b.size=1}if(typeof b.value=='string'){var j=b.value.split(";"),m,i;jQuery(c).attr({id:b.id,name:b.name,size:Math.min(b.size,j.length)});for(var l=0;l<j.length;l++){m=j[l].split(":");i=document.createElement("option");i.value=m[0];i.innerHTML=jQuery.htmlDecode(m[1]);if(!f&&m[1]==e)i.selected="selected";if(f&&jQuery.inArray(jQuery.trim(m[1]),k)>-1){i.selected="selected"}c.appendChild(i)}}else if(typeof b.value=='object'){var n=b.value;var l=0;for(var o in n){l++;i=document.createElement("option");i.value=o;i.innerHTML=jQuery.htmlDecode(n[o]);if(!f&&n[o]==e){i.selected="selected"}if(f&&jQuery.inArray(jQuery.trim(n[o]),k)>-1){i.selected="selected"}c.appendChild(i)}jQuery(c).attr({id:b.id,name:b.name,size:Math.min(b.size,l)})}}break;case"text":c=document.createElement("input");c.type="text";e=jQuery.htmlDecode(e);c.value=e;if(!b.size&&h){jQuery(c).css({width:"98%"})}jQuery(c).attr(b);break;case"password":c=document.createElement("input");c.type="password";e=jQuery.htmlDecode(e);c.value=e;if(!b.size&&h){jQuery(c).css("width","99%")}jQuery(c).attr(b);break;case"image":c=document.createElement("input");c.type="image";jQuery(c).attr(b);break}return c};function checkValues(a,d,b){if(d>=0){var e=b.p.colModel[d].editrules}if(e){if(e.required===true){if(a.match(/^s+$/)||a=="")return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.required,""]}var h=e.required===false?false:true;if(e.number===true){if(!(h===false&&isEmpty(a))){if(isNaN(a))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.number,""]}}if(e.minValue&&!isNaN(e.minValue)){if(parseFloat(a)<parseFloat(e.minValue))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.minValue+" "+e.minValue,""]}if(e.maxValue&&!isNaN(e.maxValue)){if(parseFloat(a)>parseFloat(e.maxValue))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.maxValue+" "+e.maxValue,""]}if(e.email===true){if(!(h===false&&isEmpty(a))){var c=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!c.test(a)){return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.email,""]}}}if(e.integer===true){if(!(h===false&&isEmpty(a))){if(isNaN(a))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.integer,""];if((a%1!=0)||(a.indexOf('.')!=-1))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.integer,""]}}if(e.date===true){if(!(h===false&&isEmpty(a))){var g=b.p.colModel[d].datefmt||"Y-m-d";if(!checkDate(g,a))return[false,b.p.colNames[d]+": "+jQuery.jgrid.edit.msg.date+" - "+g,""]}}}return[true,"",""]};function checkDate(a,d){var b={};var e=false;var h;a=a.toLowerCase();if(a.indexOf("/")!=-1){h="/"}else if(a.indexOf("-")!=-1){h="-"}else if(a.indexOf(".")!=-1){h="."}else{h="/"}a=a.split(h);d=d.split(h);if(d.length!=3)return false;var c=-1,g,f=-1,k=-1;for(var j=0;j<a.length;j++){var m=isNaN(d[j])?0:parseInt(d[j],10);b[a[j]]=m;g=a[j];if(g.indexOf("y")!=-1){c=j}if(g.indexOf("m")!=-1){k=j}if(g.indexOf("d")!=-1){f=j}}if(a[c]=="y"||a[c]=="yyyy"){g=4}else if(a[c]=="yy"){g=2}else{g=-1}var i=DaysArray(12);var l;if(c===-1){return false}else{l=b[a[c]].toString();if(g==2&&l.length==1){g=1}if(l.length!=g||b[a[c]]==0){return false}}if(k===-1){return false}else{l=b[a[k]].toString();if(l.length<1||b[a[k]]<1||b[a[k]]>12){return false}}if(f===-1){return false}else{l=b[a[f]].toString();if(l.length<1||b[a[f]]<1||b[a[f]]>31||(b[a[k]]==2&&b[a[f]]>daysInFebruary(b[a[c]]))||b[a[f]]>i[b[a[k]]]){return false}}return true}function daysInFebruary(a){return(((a%4==0)&&((!(a%100==0))||(a%400==0)))?29:28)}function DaysArray(a){for(var d=1;d<=a;d++){this[d]=31;if(d==4||d==6||d==9||d==11){this[d]=30}if(d==2){this[d]=29}}return this}function isEmpty(a){if(a.match(/^s+$/)||a==""){return true}else{return false}}function htmlEncode(a){return!a?a:String(a).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}